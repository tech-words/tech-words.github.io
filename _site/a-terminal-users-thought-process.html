<!doctype html>

<!--
## Features:

- Keep CSS inline: It will be small enough not to add much weight to the page, which means it's better to avoid the extra HTTP call to request CSS
- Use system fonts: But it's hard to find a nice system font for both Linux, Windows and MacOS

- Google colours for links
- Visual box around article to highlight it
- Navigation - don't get in the way
- 

JavaScript:

- Only use enhancements that aren't necessary:
  - Document outline on the left
  - Add "title" to links

-->

<html lang="en">

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Command-line usability: A terminal user's thought process</title>

  <meta name="description" content="As a terminal user with a keen interest in usability, I explored my thought process when learning a new CLI tool, and made some basic UX recommendations.">

  <!-- Social media -->
  <meta property='article:author' content='https://twitter.com/nottrobin' />
  <meta property='article:publisher' content='https://robinwinslow.uk' />
  <meta property="og:image" content="https://www.thebluediamondgallery.com/tablet/images/blog.jpg" />
  <meta property="og:url" content="https://robinwinslow.uk/a-terminal-users-thought-process" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="Command-line usability: A terminal user's thought process" />
  <!-- Keep Terry Pratchett alive in the network https://xclacksoverhead.org/home/about -->
  <meta http-equiv="x-clacks-overhead" content="GNU Terry Pratchett" />

  <link type="application/atom+xml" rel="alternative" href="/rss.xml" />

  <style>
    /**
       * Font size
       * 
       * For usability, bigger text is almost always better. People continue to Especially as resolutions get higher
       * 
       */

    body {
      font-family: "dejavu Sans light", sans-serif;
      font-size: 1.5rem;
      background-color: #efefef;
      margin: 0;
    }

    time,
    .subtitle {
      color: #767676;
    }

    h1,
    h2,
    h3,
    h4 {
      font-weight: normal;
      margin-top: 2em;
      margin-bottom: 1em;
    }

    h1 {
      font-size: 2em;
    }

    h2 {
      font-size: 1.5em;
    }

    h3 {
      font-size: 1.2em;
    }

    h4 {
      font-size: 1.1em;
    }

    p {
      line-height: 1.5em;
    }

    a {
      color: #1a0dab;
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    a:visited {
      color: #551A8B;
    }

    input,
    button {
      appearance: none;
      border: 1px solid lightgray;
      font-size: 1em;
      max-width: 100%;
      padding: 0.5em 0.8em;
    }

    article {
      margin: auto;
      padding: 3em 5em;
      max-width: 35em;
      background-color: white;
    }

    @media (max-width: 1080px) {
      article {
        padding: 0.5em 1.5em;
      }
    }

    article p,
    article ul,
    article ol {
      margin-block-start: 1.5em;
      margin-block-end: 1.5em;
    }

    article li {
      margin-block-start: 1em;
      margin-block-end: 1em;
      line-height: 1.5em;
    }

    blockquote {
      padding: 1em 1.5em;
      margin: 1.5em 0;
      border-left: 2px solid #ddd;
      font-style: italic;
    }

    blockquote p {
      display: inline;
    }

    pre {
      overflow-x: auto;
      background-color: #eee;
      padding: 1em;
      line-height: 125%;
    }

    img {
      max-width: 100%;
    }

    code {
      padding: 0.125em 0.25em;
      line-height: 1.6em;
      margin: 0;
      font-size: 0.8em;
      background-color: #f0f0f0;
      border-radius: 6px;
    }

    pre code {
      line-height: inherit;
      padding: 0;
    }

    hr {
      margin: 3em 0;
    }

    /* Classes */
    .article-header {
      margin: auto;
      max-width: 60em;
      padding: 3em 1em;
      text-align: center;
    }

    .article-header h1 {
      font-size: 3em;
      margin: 0 0 0.5em 0;
    }

    @media (max-width: 1080px) {
      .article-header h1 {
        font-size: 2.3em;
      }
    }

    .back-to-home {
      padding: 0 1.5em;
    }

    .title {
      text-align: center;
      margin: 1em 1em 2em 1em;
    }

    .title h1 {
      margin-bottom: 0;
    }

    .title p {
      margin-top: 0.25em;
    }

    .search-form {
      text-align: center;
      margin: 0.8em 1em;
    }

    .search-form input,
    .search-form button {
      margin: 0.2em 0;
    }

    .posts li {
      margin: 3em 0;
    }

    .posts li article {
      padding: 0.5em 3em;
    }

    .posts li article .date {
      margin-top: 0.5em;
      font-size: 0.8em;
    }

    @media (max-width: 984px) {
      .posts li article {
        padding: 1.5em;
      }
    }

    .posts li article h1 {
      font-size: 1.5em;
      margin: 1em 0 0 0;
      font-weight: normal;
    }

    @media (max-width: 984px) {
      .posts li article h1 {
        font-size: 1.3em;
      }
    }

    .posts {
      padding: 0;
      margin: 0;
      list-style-type: none;
    }

    .see-the-code {
      padding: 1.5em;
      font-size: 0.8em;
      text-align: right;
    }

    .discuss {
      text-align: center;
      font-style: italic;
    }

    .author {
      text-align: center;
      margin: 3em;
      font-style: normal;
    }

    .more-posts {
      padding: 1.5em 3em;
      margin: auto;
      background-color: white;
      max-width: 35em;
    }

    .more-posts h2 {
      margin-top: 1em;
    }

    .more-posts time {
      font-size: 0.8em;
    }

    .headings {
      position: absolute;
      text-align: right;
      font-size: 0.8em;
      opacity: 0.5;
      position: fixed;
      display: none;
    }

    .headings ol {
      margin: 6em 6em 1.5em 1.5em;
      padding: 0;
    }

    .headings ol li {
      list-style-type: none;
      margin: 1.5em 0 0 0;
    }

    .headings ol li.h2 {
      font-size: 0.8em;
      opacity: 0.8;
      margin: 0.7em 0 0 0;
    }

    .heading-link {
      opacity: 0.4;
      font-size: 2rem;
    }

    table {
      border-spacing: 0;
      font-size: 0.8em;
    }

    td {
      padding: 1em;
      border-left: 1px dotted #666;
      border-top: 1px dotted #666;
    }

    td:last-child {
      border-right: 1px dotted #666;
    }

    tr:last-child td {
      border-bottom: 1px dotted #666;
    }

    /* Pygments syntax highlighting autumn theme */
    td.linenos pre {
      color: #000000;
      background-color: #f0f0f0;
      padding-left: 5px;
      padding-right: 5px;
    }

    span.linenos {
      color: #000000;
      background-color: #f0f0f0;
      padding-left: 5px;
      padding-right: 5px;
    }

    td.linenos pre.special {
      color: #000000;
      background-color: #ffffc0;
      padding-left: 5px;
      padding-right: 5px;
    }

    span.linenos.special {
      color: #000000;
      background-color: #ffffc0;
      padding-left: 5px;
      padding-right: 5px;
    }

    .highlight .hll {
      background-color: #ffffcc
    }

    .highlight {
      background: #f0f0f0;
    }

    .highlight .c {
      color: #60a0b0;
      font-style: italic
    }

    .highlight .err {
      border: 1px solid #FF0000
    }

    .highlight .k {
      color: #007020;
      font-weight: bold
    }

    .highlight .o {
      color: #666666
    }

    .highlight .ch {
      color: #60a0b0;
      font-style: italic
    }

    .highlight .cm {
      color: #60a0b0;
      font-style: italic
    }

    .highlight .cp {
      color: #007020
    }

    .highlight .cpf {
      color: #60a0b0;
      font-style: italic
    }

    .highlight .c1 {
      color: #60a0b0;
      font-style: italic
    }

    .highlight .cs {
      color: #60a0b0;
      background-color: #fff0f0
    }

    .highlight .gd {
      color: #A00000
    }

    .highlight .ge {
      font-style: italic
    }

    .highlight .gr {
      color: #FF0000
    }

    .highlight .gh {
      color: #000080;
      font-weight: bold
    }

    .highlight .gi {
      color: #00A000
    }

    .highlight .go {
      color: #888888
    }

    .highlight .gp {
      color: #c65d09;
      font-weight: bold
    }

    .highlight .gs {
      font-weight: bold
    }

    .highlight .gu {
      color: #800080;
      font-weight: bold
    }

    .highlight .gt {
      color: #0044DD
    }

    .highlight .kc {
      color: #007020;
      font-weight: bold
    }

    .highlight .kd {
      color: #007020;
      font-weight: bold
    }

    .highlight .kn {
      color: #007020;
      font-weight: bold
    }

    .highlight .kp {
      color: #007020
    }

    .highlight .kr {
      color: #007020;
      font-weight: bold
    }

    .highlight .kt {
      color: #902000
    }

    .highlight .m {
      color: #40a070
    }

    .highlight .s {
      color: #4070a0
    }

    .highlight .na {
      color: #4070a0
    }

    .highlight .nb {
      color: #007020
    }

    .highlight .nc {
      color: #0e84b5;
      font-weight: bold
    }

    .highlight .no {
      color: #60add5
    }

    .highlight .nd {
      color: #555555;
      font-weight: bold
    }

    .highlight .ni {
      color: #d55537;
      font-weight: bold
    }

    .highlight .ne {
      color: #007020
    }

    .highlight .nf {
      color: #06287e
    }

    .highlight .nl {
      color: #002070;
      font-weight: bold
    }

    .highlight .nn {
      color: #0e84b5;
      font-weight: bold
    }

    .highlight .nt {
      color: #062873;
      font-weight: bold
    }

    .highlight .nv {
      color: #bb60d5
    }

    .highlight .ow {
      color: #007020;
      font-weight: bold
    }

    .highlight .w {
      color: #bbbbbb
    }

    .highlight .mb {
      color: #40a070
    }

    .highlight .mf {
      color: #40a070
    }

    .highlight .mh {
      color: #40a070
    }

    .highlight .mi {
      color: #40a070
    }

    .highlight .mo {
      color: #40a070
    }

    .highlight .sa {
      color: #4070a0
    }

    .highlight .sb {
      color: #4070a0
    }

    .highlight .sc {
      color: #4070a0
    }

    .highlight .dl {
      color: #4070a0
    }

    .highlight .sd {
      color: #4070a0;
      font-style: italic
    }

    .highlight .s2 {
      color: #4070a0
    }

    .highlight .se {
      color: #4070a0;
      font-weight: bold
    }

    .highlight .sh {
      color: #4070a0
    }

    .highlight .si {
      color: #70a0d0;
      font-style: italic
    }

    .highlight .sx {
      color: #c65d09
    }

    .highlight .sr {
      color: #235388
    }

    .highlight .s1 {
      color: #4070a0
    }

    .highlight .ss {
      color: #517918
    }

    .highlight .bp {
      color: #007020
    }

    .highlight .fm {
      color: #06287e
    }

    .highlight .vc {
      color: #bb60d5
    }

    .highlight .vg {
      color: #bb60d5
    }

    .highlight .vi {
      color: #bb60d5
    }

    .highlight .vm {
      color: #bb60d5
    }

    .highlight .il {
      color: #40a070
    }
  </style>
</head>

<body>
  <nav class="back-to-home">
  <p><a href="/">← Posts</a></h1></p>
</nav>

<header class="article-header">
  <h1>Command-line usability: A terminal user's thought process</h1>
  <time datetime="2017-09-07">7th September 2017</time>
</header>

<nav class="headings">
  <ol>
    <li><a href="#top">↑ top</a></li>
  </ol>
</nav>

<article>
  <p>I’ve been thinking about the usability of command-line terminals a lot recently.</p>

<p>Command-line interfaces remain mystifying to many people. Usability hobbyists seem as inclined to ask <a href="https://ux.stackexchange.com/questions/101990/why-are-terminal-consoles-still-used" title="UX StackExchange: Why are terminal consoles still being used?">why the terminal exists</a>, as how to optimise it. I’ve also had it suggested to me that the discipline of User Experience (UX) has little to offer the Command-Line Interface (CLI), because the habits of terminal users are too inherent or instinctive to be defined and optimised by usability experts.</p>

<p>As an experienced terminal user with a keen interest in usability, I disagree that usability has little to offer the CLI experience. I believe that the experience can be improved through the application of usability principles just as much as for more graphical domains.</p>

<h2 id="steps-to-learn-a-new-cli-tool">Steps to learn a new CLI tool</h2>

<p>To help demystify the command-line experience, I’m going to lay out some of the patterns of thinking and behaviour that define my use of the CLI.</p>

<p>New CLI tools I’ve learned recently include <a href="https://snapcraft.io/docs/core/usage" title="Snapcraft: Use the snap command"><code class="language-plaintext highlighter-rouge">snap</code></a>, <a href="https://kubernetes.io/docs/user-guide/kubectl-overview/" title="Kubernetes: Kubectl overview"><code class="language-plaintext highlighter-rouge">kubectl</code></a> and <a href="https://nghttp2.org/" title="Nghttp2: HTTP/2 C Library"><code class="language-plaintext highlighter-rouge">nghttp2</code></a>, and I’ve also <a href="https://github.com/canonical-webteam/practices/blob/master/local-development/the-run-script.md" title="Canonical webteam practices: The ./run script interface">dabbled</a> in writing command-line tools myself.</p>

<p>Below I’ll map out an example of the steps I might go through when discovering a new command-line tool, as a basis for exploring how these tools could be optimised for CLI users.</p>

<ol>
  <li>Install the tool
    <ul>
      <li>First, I might try <code class="language-plaintext highlighter-rouge">apt install {tool}</code> (or <code class="language-plaintext highlighter-rouge">brew install {tool}</code> on a mac)</li>
      <li>If that fails, I’ll probably search the internet for “Install {tool}” and hope to find the official documentation</li>
    </ul>
  </li>
  <li>Check it is installed, and if <a href="https://www.howtogeek.com/195207/use-tab-completion-to-type-commands-faster-on-any-operating-system/" title="How To Geek: Use Tab Completion">tab-complete</a> works
    <ul>
      <li>Type the first few characters of the command name (<code class="language-plaintext highlighter-rouge">sna</code> for <code class="language-plaintext highlighter-rouge">snap</code>) followed by <code class="language-plaintext highlighter-rouge">&lt;tab&gt; &lt;tab&gt;</code>, to see if the command name auto-completes, signifying that the system is aware of its existence</li>
      <li>Hit space, and then <code class="language-plaintext highlighter-rouge">&lt;tab&gt; &lt;tab&gt;</code> again, to see if it shows me a list of available sub-commands, indicating that tab completion is set up correctly for the tool</li>
    </ul>
  </li>
  <li>Try my first command
    <ul>
      <li>I’m probably following some documentation at this point, which will be telling me the first command to run (e.g. <code class="language-plaintext highlighter-rouge">snap install {something}</code>), so I’ll try that out and expect prompt succinct feedback to show me that it’s working</li>
      <li>For basic tools, this may complete my initial interaction with the tool. For more complex tools like <code class="language-plaintext highlighter-rouge">kubectl</code> or <code class="language-plaintext highlighter-rouge">git</code> I may continue playing with it</li>
    </ul>
  </li>
  <li>Try to do something more complex
    <ul>
      <li>Now I’m likely no longer following a tutorial, instead I’m experimenting on my own, trying to discover more about the tool</li>
      <li>If what I want to do seems complex, I’ll straight away search the internet for how to do it</li>
      <li>If it seems more simple, I’ll start looking for a list of subcommands to achieve my goal</li>
      <li>I start with <code class="language-plaintext highlighter-rouge">{tool} &lt;tab&gt; &lt;tab&gt;</code> to see if it gives me a list of subcommands, in case it will be obvious what to do next from that list</li>
      <li>If that fails I’ll try, in order, <code class="language-plaintext highlighter-rouge">{tool} &lt;enter&gt;</code>, <code class="language-plaintext highlighter-rouge">{tool} -h</code>, <code class="language-plaintext highlighter-rouge">{tool} --help</code>, <code class="language-plaintext highlighter-rouge">{tool} help</code> or <code class="language-plaintext highlighter-rouge">{tool} /?</code></li>
      <li>If none of those work then I’ll try <code class="language-plaintext highlighter-rouge">man {tool}</code>, looking for a Unix manual entry</li>
      <li>If that fails then I’ll fall back to searching the internet again</li>
    </ul>
  </li>
</ol>

<h2 id="ux-recommendations">UX recommendations</h2>

<p>Considering my own experience of CLI tools, I am reasonably confident the following recommendations make good general practice guidelines:</p>

<ul>
  <li>Always implement a <code class="language-plaintext highlighter-rouge">--help</code> option on the main command and all subcommands, and if appropriate print out some help when no options are provided (<code class="language-plaintext highlighter-rouge">{tool} &lt;enter&gt;</code>)</li>
  <li>Provide both short- (e.g. <code class="language-plaintext highlighter-rouge">-h</code>) and long- (e.g. <code class="language-plaintext highlighter-rouge">--help</code>) form options, and make them guessable</li>
  <li>Carefully consider the naming of all subcommands and options, use familiar words where possible (e.g. <code class="language-plaintext highlighter-rouge">help</code>, <code class="language-plaintext highlighter-rouge">clean</code>, <code class="language-plaintext highlighter-rouge">create</code>)</li>
  <li>Be consistent with your naming - have a clear philosophy behind your use of subcommands vs options, verbs vs nouns etc.</li>
  <li>Provide helpful, readable output at all times - especially when there’s an error (<code class="language-plaintext highlighter-rouge">npm</code> I’m looking at you)</li>
  <li>Use long-form options in documentation, to make commands more self-explanatory</li>
  <li>Make the tool easy to install with common software management systems (<a href="https://www.ubuntu.com/snappy" title="Ubuntu: A ‘snap’ is a universal Linux package">snap</a>, <a href="https://wiki.debian.org/Apt" title="Apt: Debian package manager">apt</a>, <a href="https://brew.sh/" title="Homebrew: MacOS's missing package manager">Homebrew</a>, or sometimes <a href="https://www.npmjs.com/" title="NPM: the package manager for javascript">NPM</a> or <a href="https://en.wikipedia.org/wiki/Pip_(package_manager)" title="Wikipedia: pip (package manager)">pip</a>)</li>
  <li>Provide <a href="https://www.howtogeek.com/195207/use-tab-completion-to-type-commands-faster-on-any-operating-system/" title="How To Geek: Use Tab Completion">tab-completion</a>. If it can’t be installed with the tool, make it easy to install and document how to set it up in your installation guide</li>
  <li>Command outputs should use the appropriate <a href="https://en.wikipedia.org/wiki/Standard_streams" title="Wikipedia: Standard streams">output streams (STDOUT and STDERR)</a> and should be as user-friendly and succinct as possible, and ideally make use of <a href="https://unix.stackexchange.com/questions/148/colorizing-your-terminal-and-shell-environment" title="Unix StackExchange: Colorizing your terminal and shell environment?">terminal colours</a></li>
</ul>

<p>Some of these recommendations are easier to implement than others. Ideally every command should consider their subcommands and options carefully, and implement <code class="language-plaintext highlighter-rouge">--help</code>. But writing <a href="https://askubuntu.com/questions/68175/how-to-create-script-with-auto-complete" title="AskUbuntu: How to create script with auto-complete?">auto-complete scripts</a> is a significant undertaking.</p>

<p>Similarly, <a href="https://snapcraft.io/docs/build-snaps/your-first-snap" title="Snapcraft: Build your first snap">packaging your tool as a snap</a> is significantly easier than, for example, adding software to the <a href="https://help.ubuntu.com/stable/ubuntu-help/addremove-sources.html" title="Add remove sources">official Ubuntu software sources</a>.</p>

<p>Although I believe all of the above to be good general advice, I would very much welcome research to highlight the relative importance of addressing each concern.</p>

<h3 id="outstanding-questions">Outstanding questions</h3>

<p>There are a number of further questions for which the answers don’t seem obvious to me, but I’d love to somehow find out the answers:</p>

<ul>
  <li>Once users have learned the short-form options (e.g. <code class="language-plaintext highlighter-rouge">-h</code>) do they ever use the long-form (e.g. <code class="language-plaintext highlighter-rouge">--help</code>)?</li>
  <li>Do users prefer subcommands (<code class="language-plaintext highlighter-rouge">mytool create {something}</code>) or options (<code class="language-plaintext highlighter-rouge">mytool --create {something}</code>)?</li>
  <li>For multi-level commands, do users prefer <code class="language-plaintext highlighter-rouge">{tool} {object} {verb}</code> (e.g. <code class="language-plaintext highlighter-rouge">git remote add {remote_name}</code>), or <code class="language-plaintext highlighter-rouge">{tool} {verb} {object}</code> (e.g. <code class="language-plaintext highlighter-rouge">kubectl get pod {pod_name}</code>), or perhaps <code class="language-plaintext highlighter-rouge">{tool} {verb}-{object}</code> (e.g. <code class="language-plaintext highlighter-rouge">juju remove-application {app_name}</code>)?</li>
  <li>What patterns exist for formatting command output? What’s the optimal length for users to read, and what types of formatting do users find easiest to understand?</li>
</ul>

<p>If you know of either authoritative recommendations or existing research on these topics, please let me know in the comments below.</p>

<p>I’ll try to write a more in-depth follow-up to this post when I’ve explored a bit further on some of these topics.</p>



  
</article>

<script>
  /**
   * Document outline
   */

  // Get elements
  let article = document.querySelector("article");
  let headings = document.querySelector(".headings");
  let list = headings.querySelector("ol");

  // Populate nav
  article.querySelectorAll("h1, h2").forEach(function (heading) {
    let item = document.createElement("li");
    item.classList.add(heading.tagName.toLowerCase());
    item.innerHTML = `<a href="#${heading.id}">${heading.textContent}</a>`;
    list.appendChild(item);
  });

  function toggleHeadings() {
    // Don't show if there's not space
    if (article.offsetLeft < 180) {
      headings.style.display = "none";
      return;
    }

    // More compact layout
    if (article.offsetLeft < 350) {
      list.style.marginRight = "1.5em";
    } else {
      list.style.marginRight = "6em";
    }

    let articleBounding = article.getBoundingClientRect();
    let rightOffset = document.body.offsetWidth - articleBounding.left;

    headings.style.display = "block";
    headings.style.right = rightOffset + "px";

    if (articleBounding.top > 0) {
      headings.style.top = articleBounding.top + "px";
    } else {
      headings.style.top = 0;
    }
  }

  window.addEventListener('scroll', toggleHeadings);
  window.addEventListener('resize', toggleHeadings);

  toggleHeadings();
</script>

<address class="author">
  By <a href="https://twitter.com/nottrobin">@nottrobin</a>
</address>





<nav class="more-posts">
  <h2>More posts</h2>
  
  <p>
    <a href="/blogging-from-my-phone-with-gitjournal">Blogging from my phone with GitJournal</a><br>
    <time datetime="2022-06-05">5th June 2022</time>
  </p>
  
  
  <p>
    <a href="/how-to-manage-git-history">How to manage your Git history: Tips for keeping your commits tidy</a><br>
    <time datetime="2018-12-11">11th December 2018</time>
  </p>
  
  
  <p>
    <a href="/fix-docker-networking-dns">Fix Docker's networking DNS config</a><br>
    <time datetime="2016-06-22">22nd June 2016</time>
  </p>
  
</nav>


  <footer class="see-the-code">
    <a href="https://github.com/nottrobin/robinwinslow.uk">☵ See the code</a>
  </footer>

  <!-- Instant.page -->
  <script>
    let mouseoverTimer; let lastTouchTimestamp; const prefetches = new Set; const prefetchElement = document.createElement("link"); const isSupported = prefetchElement.relList && prefetchElement.relList.supports && prefetchElement.relList.supports("prefetch") && window.IntersectionObserver && "isIntersecting" in IntersectionObserverEntry.prototype; const allowQueryString = "instantAllowQueryString" in document.body.dataset; const allowExternalLinks = "instantAllowExternalLinks" in document.body.dataset; const useWhitelist = "instantWhitelist" in document.body.dataset; const mousedownShortcut = "instantMousedownShortcut" in document.body.dataset; const DELAY_TO_NOT_BE_CONSIDERED_A_TOUCH_INITIATED_ACTION = 1111; let delayOnHover = 65; let useMousedown = false; let useMousedownOnly = false; let useViewport = false; if ("instantIntensity" in document.body.dataset) { const intensity = document.body.dataset.instantIntensity; if (intensity.substr(0, "mousedown".length) == "mousedown") { useMousedown = true; if (intensity == "mousedown-only") { useMousedownOnly = true } } else if (intensity.substr(0, "viewport".length) == "viewport") { if (!(navigator.connection && (navigator.connection.saveData || navigator.connection.effectiveType && navigator.connection.effectiveType.includes("2g")))) { if (intensity == "viewport") { if (document.documentElement.clientWidth * document.documentElement.clientHeight < 45e4) { useViewport = true } } else if (intensity == "viewport-all") { useViewport = true } } } else { const milliseconds = parseInt(intensity); if (!isNaN(milliseconds)) { delayOnHover = milliseconds } } } if (isSupported) { const eventListenersOptions = { capture: true, passive: true }; if (!useMousedownOnly) { document.addEventListener("touchstart", touchstartListener, eventListenersOptions) } if (!useMousedown) { document.addEventListener("mouseover", mouseoverListener, eventListenersOptions) } else if (!mousedownShortcut) { document.addEventListener("mousedown", mousedownListener, eventListenersOptions) } if (mousedownShortcut) { document.addEventListener("mousedown", mousedownShortcutListener, eventListenersOptions) } if (useViewport) { let triggeringFunction; if (window.requestIdleCallback) { triggeringFunction = (callback => { requestIdleCallback(callback, { timeout: 1500 }) }) } else { triggeringFunction = (callback => { callback() }) } triggeringFunction(() => { const intersectionObserver = new IntersectionObserver(entries => { entries.forEach(entry => { if (entry.isIntersecting) { const linkElement = entry.target; intersectionObserver.unobserve(linkElement); preload(linkElement.href) } }) }); document.querySelectorAll("a").forEach(linkElement => { if (isPreloadable(linkElement)) { intersectionObserver.observe(linkElement) } }) }) } } function touchstartListener(event) { lastTouchTimestamp = performance.now(); const linkElement = event.target.closest("a"); if (!isPreloadable(linkElement)) { return } preload(linkElement.href) } function mouseoverListener(event) { if (performance.now() - lastTouchTimestamp < DELAY_TO_NOT_BE_CONSIDERED_A_TOUCH_INITIATED_ACTION) { return } const linkElement = event.target.closest("a"); if (!isPreloadable(linkElement)) { return } linkElement.addEventListener("mouseout", mouseoutListener, { passive: true }); mouseoverTimer = setTimeout(() => { preload(linkElement.href); mouseoverTimer = undefined }, delayOnHover) } function mousedownListener(event) { const linkElement = event.target.closest("a"); if (!isPreloadable(linkElement)) { return } preload(linkElement.href) } function mouseoutListener(event) { if (event.relatedTarget && event.target.closest("a") == event.relatedTarget.closest("a")) { return } if (mouseoverTimer) { clearTimeout(mouseoverTimer); mouseoverTimer = undefined } } function mousedownShortcutListener(event) { if (performance.now() - lastTouchTimestamp < DELAY_TO_NOT_BE_CONSIDERED_A_TOUCH_INITIATED_ACTION) { return } const linkElement = event.target.closest("a"); if (event.which > 1 || event.metaKey || event.ctrlKey) { return } if (!linkElement) { return } linkElement.addEventListener("click", function (event) { if (event.detail == 1337) { return } event.preventDefault() }, { capture: true, passive: false, once: true }); const customEvent = new MouseEvent("click", { view: window, bubbles: true, cancelable: false, detail: 1337 }); linkElement.dispatchEvent(customEvent) } function isPreloadable(linkElement) { if (!linkElement || !linkElement.href) { return } if (useWhitelist && !("instant" in linkElement.dataset)) { return } if (!allowExternalLinks && linkElement.origin != location.origin && !("instant" in linkElement.dataset)) { return } if (!["http:", "https:"].includes(linkElement.protocol)) { return } if (linkElement.protocol == "http:" && location.protocol == "https:") { return } if (!allowQueryString && linkElement.search && !("instant" in linkElement.dataset)) { return } if (linkElement.hash && linkElement.pathname + linkElement.search == location.pathname + location.search) { return } if ("noInstant" in linkElement.dataset) { return } return true } function preload(url) { if (prefetches.has(url)) { return } const prefetcher = document.createElement("link"); prefetcher.rel = "prefetch"; prefetcher.href = url; document.head.appendChild(prefetcher); prefetches.add(url) }
  </script>
</body>

</html>
