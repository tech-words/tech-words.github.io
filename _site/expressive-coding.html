<!doctype html>

<!--
## Features:

- Keep CSS inline: It will be small enough not to add much weight to the page, which means it's better to avoid the extra HTTP call to request CSS
- Use system fonts: But it's hard to find a nice system font for both Linux, Windows and MacOS

- Google colours for links
- Visual box around article to highlight it
- Navigation - don't get in the way
- 

JavaScript:

- Only use enhancements that aren't necessary:
  - Document outline on the left
  - Add "title" to links

-->

<html lang="en">

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Writing expressive code</title>

  <meta name="description" content="Reading some legacy code today reminded me of some general principles that programmers could follow to make code easier to manage for future developers. I may have got a bit carried away...">

  <!-- Social media -->
  <meta property='article:author' content='https://twitter.com/nottrobin' />
  <meta property='article:publisher' content='https://robinwinslow.uk' />
  <meta property="og:image" content="https://www.thebluediamondgallery.com/tablet/images/blog.jpg" />
  <meta property="og:url" content="https://robinwinslow.uk/expressive-coding" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="Writing expressive code" />
  <!-- Keep Terry Pratchett alive in the network https://xclacksoverhead.org/home/about -->
  <meta http-equiv="x-clacks-overhead" content="GNU Terry Pratchett" />

  <link type="application/atom+xml" rel="alternative" href="/rss.xml" />

  <style>
    /**
       * Font size
       * 
       * For usability, bigger text is almost always better. People continue to Especially as resolutions get higher
       * 
       */

    body {
      font-family: "dejavu Sans light", sans-serif;
      font-size: 1.5rem;
      background-color: #efefef;
      margin: 0;
    }

    time,
    .subtitle {
      color: #767676;
    }

    h1,
    h2,
    h3,
    h4 {
      font-weight: normal;
      margin-top: 2em;
      margin-bottom: 1em;
    }

    h1 {
      font-size: 2em;
    }

    h2 {
      font-size: 1.5em;
    }

    h3 {
      font-size: 1.2em;
    }

    h4 {
      font-size: 1.1em;
    }

    p {
      line-height: 1.5em;
    }

    a {
      color: #1a0dab;
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    a:visited {
      color: #551A8B;
    }

    input,
    button {
      appearance: none;
      border: 1px solid lightgray;
      font-size: 1em;
      max-width: 100%;
      padding: 0.5em 0.8em;
    }

    article {
      margin: auto;
      padding: 3em 5em;
      max-width: 35em;
      background-color: white;
    }

    @media (max-width: 1080px) {
      article {
        padding: 0.5em 1.5em;
      }
    }

    article p,
    article ul,
    article ol {
      margin-block-start: 1.5em;
      margin-block-end: 1.5em;
    }

    article li {
      margin-block-start: 1em;
      margin-block-end: 1em;
      line-height: 1.5em;
    }

    blockquote {
      padding: 1em 1.5em;
      margin: 1.5em 0;
      border-left: 2px solid #ddd;
      font-style: italic;
    }

    blockquote p {
      display: inline;
    }

    pre {
      overflow-x: auto;
      background-color: #eee;
      padding: 1em;
      line-height: 125%;
    }

    img {
      max-width: 100%;
    }

    code {
      padding: 0.125em 0.25em;
      line-height: 1.6em;
      margin: 0;
      font-size: 0.8em;
      background-color: #f0f0f0;
      border-radius: 6px;
    }

    pre code {
      line-height: inherit;
      padding: 0;
    }

    hr {
      margin: 3em 0;
    }

    /* Classes */
    .article-header {
      margin: auto;
      max-width: 60em;
      padding: 3em 1em;
      text-align: center;
    }

    .article-header h1 {
      font-size: 3em;
      margin: 0 0 0.5em 0;
    }

    @media (max-width: 1080px) {
      .article-header h1 {
        font-size: 2.3em;
      }
    }

    .back-to-home {
      padding: 0 1.5em;
    }

    .title {
      text-align: center;
      margin: 1em 1em 2em 1em;
    }

    .title h1 {
      margin-bottom: 0;
    }

    .title p {
      margin-top: 0.25em;
    }

    .search-form {
      text-align: center;
      margin: 0.8em 1em;
    }

    .search-form input,
    .search-form button {
      margin: 0.2em 0;
    }

    .posts li {
      margin: 3em 0;
    }

    .posts li article {
      padding: 0.5em 3em;
    }

    .posts li article .date {
      margin-top: 0.5em;
      font-size: 0.8em;
    }

    @media (max-width: 984px) {
      .posts li article {
        padding: 1.5em;
      }
    }

    .posts li article h1 {
      font-size: 1.5em;
      margin: 1em 0 0 0;
      font-weight: normal;
    }

    @media (max-width: 984px) {
      .posts li article h1 {
        font-size: 1.3em;
      }
    }

    .posts {
      padding: 0;
      margin: 0;
      list-style-type: none;
    }

    .see-the-code {
      padding: 1.5em;
      font-size: 0.8em;
      text-align: right;
    }

    .discuss {
      text-align: center;
      font-style: italic;
    }

    .author {
      text-align: center;
      margin: 3em;
      font-style: normal;
    }

    .more-posts {
      padding: 1.5em 3em;
      margin: auto;
      background-color: white;
      max-width: 35em;
    }

    .more-posts h2 {
      margin-top: 1em;
    }

    .more-posts time {
      font-size: 0.8em;
    }

    .headings {
      position: absolute;
      text-align: right;
      font-size: 0.8em;
      opacity: 0.5;
      position: fixed;
      display: none;
    }

    .headings ol {
      margin: 6em 6em 1.5em 1.5em;
      padding: 0;
    }

    .headings ol li {
      list-style-type: none;
      margin: 1.5em 0 0 0;
    }

    .headings ol li.h2 {
      font-size: 0.8em;
      opacity: 0.8;
      margin: 0.7em 0 0 0;
    }

    .heading-link {
      opacity: 0.4;
      font-size: 2rem;
    }

    table {
      border-spacing: 0;
      font-size: 0.8em;
    }

    td {
      padding: 1em;
      border-left: 1px dotted #666;
      border-top: 1px dotted #666;
    }

    td:last-child {
      border-right: 1px dotted #666;
    }

    tr:last-child td {
      border-bottom: 1px dotted #666;
    }

    /* Pygments syntax highlighting autumn theme */
    td.linenos pre {
      color: #000000;
      background-color: #f0f0f0;
      padding-left: 5px;
      padding-right: 5px;
    }

    span.linenos {
      color: #000000;
      background-color: #f0f0f0;
      padding-left: 5px;
      padding-right: 5px;
    }

    td.linenos pre.special {
      color: #000000;
      background-color: #ffffc0;
      padding-left: 5px;
      padding-right: 5px;
    }

    span.linenos.special {
      color: #000000;
      background-color: #ffffc0;
      padding-left: 5px;
      padding-right: 5px;
    }

    .highlight .hll {
      background-color: #ffffcc
    }

    .highlight {
      background: #f0f0f0;
    }

    .highlight .c {
      color: #60a0b0;
      font-style: italic
    }

    .highlight .err {
      border: 1px solid #FF0000
    }

    .highlight .k {
      color: #007020;
      font-weight: bold
    }

    .highlight .o {
      color: #666666
    }

    .highlight .ch {
      color: #60a0b0;
      font-style: italic
    }

    .highlight .cm {
      color: #60a0b0;
      font-style: italic
    }

    .highlight .cp {
      color: #007020
    }

    .highlight .cpf {
      color: #60a0b0;
      font-style: italic
    }

    .highlight .c1 {
      color: #60a0b0;
      font-style: italic
    }

    .highlight .cs {
      color: #60a0b0;
      background-color: #fff0f0
    }

    .highlight .gd {
      color: #A00000
    }

    .highlight .ge {
      font-style: italic
    }

    .highlight .gr {
      color: #FF0000
    }

    .highlight .gh {
      color: #000080;
      font-weight: bold
    }

    .highlight .gi {
      color: #00A000
    }

    .highlight .go {
      color: #888888
    }

    .highlight .gp {
      color: #c65d09;
      font-weight: bold
    }

    .highlight .gs {
      font-weight: bold
    }

    .highlight .gu {
      color: #800080;
      font-weight: bold
    }

    .highlight .gt {
      color: #0044DD
    }

    .highlight .kc {
      color: #007020;
      font-weight: bold
    }

    .highlight .kd {
      color: #007020;
      font-weight: bold
    }

    .highlight .kn {
      color: #007020;
      font-weight: bold
    }

    .highlight .kp {
      color: #007020
    }

    .highlight .kr {
      color: #007020;
      font-weight: bold
    }

    .highlight .kt {
      color: #902000
    }

    .highlight .m {
      color: #40a070
    }

    .highlight .s {
      color: #4070a0
    }

    .highlight .na {
      color: #4070a0
    }

    .highlight .nb {
      color: #007020
    }

    .highlight .nc {
      color: #0e84b5;
      font-weight: bold
    }

    .highlight .no {
      color: #60add5
    }

    .highlight .nd {
      color: #555555;
      font-weight: bold
    }

    .highlight .ni {
      color: #d55537;
      font-weight: bold
    }

    .highlight .ne {
      color: #007020
    }

    .highlight .nf {
      color: #06287e
    }

    .highlight .nl {
      color: #002070;
      font-weight: bold
    }

    .highlight .nn {
      color: #0e84b5;
      font-weight: bold
    }

    .highlight .nt {
      color: #062873;
      font-weight: bold
    }

    .highlight .nv {
      color: #bb60d5
    }

    .highlight .ow {
      color: #007020;
      font-weight: bold
    }

    .highlight .w {
      color: #bbbbbb
    }

    .highlight .mb {
      color: #40a070
    }

    .highlight .mf {
      color: #40a070
    }

    .highlight .mh {
      color: #40a070
    }

    .highlight .mi {
      color: #40a070
    }

    .highlight .mo {
      color: #40a070
    }

    .highlight .sa {
      color: #4070a0
    }

    .highlight .sb {
      color: #4070a0
    }

    .highlight .sc {
      color: #4070a0
    }

    .highlight .dl {
      color: #4070a0
    }

    .highlight .sd {
      color: #4070a0;
      font-style: italic
    }

    .highlight .s2 {
      color: #4070a0
    }

    .highlight .se {
      color: #4070a0;
      font-weight: bold
    }

    .highlight .sh {
      color: #4070a0
    }

    .highlight .si {
      color: #70a0d0;
      font-style: italic
    }

    .highlight .sx {
      color: #c65d09
    }

    .highlight .sr {
      color: #235388
    }

    .highlight .s1 {
      color: #4070a0
    }

    .highlight .ss {
      color: #517918
    }

    .highlight .bp {
      color: #007020
    }

    .highlight .fm {
      color: #06287e
    }

    .highlight .vc {
      color: #bb60d5
    }

    .highlight .vg {
      color: #bb60d5
    }

    .highlight .vi {
      color: #bb60d5
    }

    .highlight .vm {
      color: #bb60d5
    }

    .highlight .il {
      color: #40a070
    }
  </style>
</head>

<body>
  <nav class="back-to-home">
  <p><a href="/">← Posts</a></h1></p>
</nav>

<header class="article-header">
  <h1>Writing expressive code</h1>
  <time datetime="2013-11-21">21st November 2013</time>
</header>

<nav class="headings">
  <ol>
    <li><a href="#top">↑ top</a></li>
  </ol>
</nav>

<article>
  <p>As any coder gains experience, they inevitebly learn more and more ways to solve the same problem.</p>

<p>The very first consideration is simplicity. We probably want to use as simple and direct a solution as possible - to avoid over-engineering. But the <em>simplest</em> solution is not necessarily the <em>shortest</em> solution.</p>

<p>After simplicity, the very next consideration should be <em>expressiveness</em>. You should always be thinking about how deeply a new developer is going to have to delve into your code to understand what’s going on.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Code is poetry
</code></pre></div></div>

<p>Writing expressive code may help future coders to understand what’s going on. It may even help you in the future. But it may also help you simply to understand the problem. Thinking carefully about how to define and encapsulate the components of your solution will often help you to understand the problem better, leading to a more logical solution.</p>

<h2 id="self-documenting-code">“Self-documenting code”</h2>

<p><a href="http://en.wikipedia.org/wiki/Self-documenting_code">“Self-documenting code”</a> is about structuring your code and choosing your method and variable names so that your code will be largely self-describing. This is a great practice, and can make some comments redundant:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$user</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">User</span><span class="p">();</span> <span class="c1">// create a new user object</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="nf">loadFromSession</span><span class="p">(</span><span class="n">session</span><span class="p">);</span> <span class="c1">// update the user from the session</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="nf">isAuthenticated</span><span class="p">())</span> <span class="p">{</span> <span class="mf">...</span> <span class="p">}</span> <span class="c1">// If the user is authenticated...</span>
</code></pre></div></div>

<p>However, as a recent discussion with <a href="http://twitter.com/karlwilliams">a friend of mine</a> highlighted to me, expressive code is not a <em>replacement</em> for comments - no code is <em>entirely</em> “self-documenting”. Always write as expresively as you can, but <em>also</em> always document where it makes sense. Methods, functions and classes should always be summarised with a comment - as mentioned in the <a href="/2014/01/05/summary-of-python-code-style-conventions/#toc_3">Python coding conventions</a>.</p>

<h2 id="wording">Wording</h2>

<p>It’s worth thinking carefully about how you name your variables and methods.</p>

<h3 id="dont-abbreviate">Don’t abbreviate</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">uid</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="c1">// I am unlikely to know what uid stands for without context</span>
<span class="kd">var</span> <span class="nx">userIdentifier</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="c1">// Better</span>
</code></pre></div></div>

<h3 id="be-specific">Be specific</h3>

<p>Use as concrete and specific nouns as you can to describe methods and functions:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">event</span><span class="p">;</span> <span class="c1">// bad - generic</span>
<span class="kd">var</span> <span class="nx">newsLinkClickEvent</span><span class="p">;</span> <span class="c1">// good - specific</span>
</code></pre></div></div>

<h2 id="encapsulation">Encapsulation</h2>

<p>No-one likes to read a really long procedural program. It’s very difficult to follow. It’s much easier to read a shorter set of well-encapsulated method calls. If you need to delve deeper, simply look in the relevant method:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Instead of showing you all the details of how we update the user</span>
<span class="c1">// We encapsulate that in the updateDetails method</span>
<span class="c1">// allowing you to quickly see the top-level processes</span>
<span class="kd">function</span> <span class="nx">saveUserDetails</span><span class="p">(</span><span class="nx">userStore</span><span class="p">,</span> <span class="nx">userDetails</span><span class="p">)</span> <span class="p">{</span>
	<span class="kd">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">();</span>
    <span class="nx">user</span><span class="p">.</span><span class="nx">updateDetails</span><span class="p">(</span><span class="nx">userDetails</span><span class="p">);</span> <span class="c1">// sets a whole bunch of details on the user</span>
    <span class="nx">userStore</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="nx">user</span><span class="p">);</span> <span class="c1">// Converts user data into the correct format, and then saves it in the user store</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="do-you-need-an-else">Do you need an <code class="language-plaintext highlighter-rouge">else</code>?</h3>

<p>The use of many <code class="language-plaintext highlighter-rouge">if .. else</code> conditionals make programs confusing. In many cases, the <code class="language-plaintext highlighter-rouge">else</code> part can be encapsulated in a separate method or function call, making the program easier to read:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// With the else</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">permissionGroup</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">administrator</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">article</span><span class="p">.</span><span class="k">delete</span><span class="p">();</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">page</span><span class="p">.</span><span class="nx">showError</span><span class="p">(</span><span class="dl">"</span><span class="s2">Sorry you don't have permission to delete this article</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Without the else</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">user</span><span class="p">.</span><span class="nx">deleteArticle</span><span class="p">(</span><span class="nx">article</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">page</span><span class="p">.</span><span class="nx">showError</span><span class="p">(</span><span class="dl">"</span><span class="s2">Sorry you don't have permission to delete this article</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>In cases where a <code class="language-plaintext highlighter-rouge">switch</code> is used, or multiple <code class="language-plaintext highlighter-rouge">if .. else if</code> statements, you could consider <a href="http://haacked.com/archive/2013/11/08/death-to-the-if-statement.aspx/">using different types</a> instead:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">User</span> <span class="p">{</span>
    <span class="k">function</span> <span class="n">deleteArticle</span><span class="p">(</span><span class="nv">$article</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$success</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">user</span><span class="o">-&gt;</span><span class="n">permissionGroup</span> <span class="o">==</span> <span class="s1">'administrator'</span>
            <span class="o">||</span> <span class="n">user</span><span class="o">-&gt;</span><span class="n">permissionGroup</span> <span class="o">==</span> <span class="s1">'editor'</span>
        <span class="p">)</span> <span class="p">{</span>
            <span class="nv">$success</span> <span class="o">=</span> <span class="nv">$article</span><span class="o">-&gt;</span><span class="nb">delete</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nv">$success</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>You can remove the need for this <code class="language-plaintext highlighter-rouge">if</code>, by making special types:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">trait</span> <span class="nc">ArticleDeletion</span> <span class="p">{</span>
    <span class="k">function</span> <span class="n">deleteArticle</span><span class="p">(</span><span class="nv">$article</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$article</span><span class="o">-&gt;</span><span class="nb">delete</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">Editor</span> <span class="kd">implements</span> <span class="nc">User</span> <span class="p">{</span> <span class="kn">use</span> <span class="nc">ArticleDeletion</span><span class="p">;</span> <span class="p">}</span>
<span class="kd">class</span> <span class="nc">Administrator</span> <span class="kd">implements</span> <span class="nc">User</span> <span class="p">{</span> <span class="kn">use</span> <span class="nc">ArticleDeletion</span><span class="p">;</span> <span class="p">}</span>
</code></pre></div></div>

<p>Notice that I’ve deliberately opted <em>not</em> to make <code class="language-plaintext highlighter-rouge">Administrator</code> inherit from <code class="language-plaintext highlighter-rouge">Editor</code>, but instead compose them separately. This keeps my structure more flat and flexible. This is an example of <a href="http://en.wikipedia.org/wiki/Composition_over_inheritance">composition over inheritence</a>.</p>

<h2 id="depth">Depth</h2>

<p>While encapsulation is often a good thing, to make programs easier to understand at the higher level, it’s important to preserve the <a href="http://en.wikipedia.org/wiki/Single_responsibility_principle">single responsibility principle</a> by not encapsulating <a href="http://en.wikipedia.org/wiki/Separation_of_concerns">separate concerns</a> together.</p>

<p>For example, one could write:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">user</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">User</span><span class="p">();</span>
<span class="n">user</span><span class="p">.</span><span class="nf">UpdateFromForm</span><span class="p">();</span> <span class="c1">// Imports user data from the page form</span>
<span class="n">user</span><span class="p">.</span><span class="nf">SaveToDatabase</span><span class="p">();</span>
</code></pre></div></div>

<p>While this is both short and fairly clear, it suffers from two other problems:</p>

<ul>
  <li>The user has to delve further into the code to find basic information, like the name of the Database class, or which form the details are stored in</li>
  <li>If we want to use a different instance of the <code class="language-plaintext highlighter-rouge">Database</code>, we have to edit the <code class="language-plaintext highlighter-rouge">User</code> class, which doesn’t make a whole lot of sense.</li>
</ul>

<p>In general you should always pass objects around, rather than instantiating them inside each other:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">user</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">User</span><span class="p">();</span>
<span class="kt">var</span> <span class="n">userData</span> <span class="p">=</span> <span class="n">Request</span><span class="p">.</span><span class="n">Form</span><span class="p">;</span>
<span class="kt">var</span> <span class="n">database</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DatabaseManager</span><span class="p">();</span>

<span class="n">user</span><span class="p">.</span><span class="nf">ImportData</span><span class="p">(</span><span class="n">userData</span><span class="p">);</span>
<span class="n">database</span><span class="p">.</span><span class="nf">Save</span><span class="p">(</span><span class="n">user</span><span class="p">);</span>
</code></pre></div></div>

<p>This is more lines, but it is nonetheless clearer what is actually happening, and it’s more versatile.</p>

<h2 id="tidiness">Tidiness</h2>

<p>Always try to format your code so that it is easily readable. Don’t be afraid of white space, and use indentation sensibly to highlight the structure of your code.</p>

<p>Where there is an accepted code style guide, you should try to follow it. For example, PHP has the <a href="https://github.com/php-fig/fig-standards/tree/master/accepted">FIG standards</a>.</p>

<p>However, I don’t think it’s worthwhile being overly anal about code standards (my thinking has evolved on this somewhat) because you’ll never be able to get everybody to code exactly the same way. So if (like me) you’re a coder who feels the need to reformat code whenever you see it to make it fit in with anal standards, you could probably so with training yourself out of that habit. As long as you can read it, leave it be.</p>

<h3 id="delete-commented-out-code">Delete commented out code</h3>

<p>If you’re using a version control system (like <a href="http://git-scm.com/">Git</a>) there really is no need to keep large blocks of commented-out or unused code. You should just delete it, to keep your codebase tidier. If you really need it again, you can just got and find it in the version control history.</p>

<h2 id="trade-offs">Trade-offs</h2>

<p>There will always be a trade-off between expresiveness and succinctness.</p>

<h3 id="depth-vs-encapsulation">Depth vs. encapsulation</h3>

<p>It is desirible to keep as flat a structure as possible in your objects, so that programmers don’t have to delve through parent class after parent class to find the relevant bit of code. But it is also important to keep code encapsulated in logical units.</p>

<p>Both the goals are often achievable by doing <a href="http://en.wikipedia.org/wiki/Composition_over_inheritance">composition over inheritence</a> using <a href="http://en.wikipedia.org/wiki/Dependency_injection">dependency injection</a> or traits / multiple inheritence.</p>

<h3 id="special-syntax">Special syntax</h3>

<p>In many languages there are often slightly obscure constructs that can nonetheless save time. With many of these there is a readability vs. simplicity trade-off.</p>

<h4 id="ternary-operators-and-null-coalescing">Ternary operators and null coalescing</h4>

<p>Both C# and PHP have null coalescing operators:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var userType = user.Type ?? defaultType; // C#
$userType = $user-&gt;Type ?: $defaultType; // PHP
</code></pre></div></div>

<p>And almost all languages support the <a href="http://en.wikipedia.org/wiki/%3F:">ternary operator</a>:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">userType</span> <span class="o">=</span> <span class="nx">user</span><span class="p">.</span><span class="nx">Type</span> <span class="o">!=</span> <span class="kc">null</span> <span class="p">?</span> <span class="nx">user</span><span class="p">.</span><span class="nx">Type</span> <span class="p">:</span> <span class="nx">defaultType</span><span class="p">;</span>
</code></pre></div></div>

<p>Both of these constructs are much more succinct than a full <code class="language-plaintext highlighter-rouge">if .. else</code> construct, but they are less semantically clear, hence the trade-off. Personally, I think it’s fine to use the ternary operator in simple conditionals like this, but if it gets any more complicated then you should always use a full <code class="language-plaintext highlighter-rouge">if .. else</code> statement.</p>

<h4 id="plugins--libraries">Plugins / libraries</h4>

<p>For example, in C#:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">brownFish</span><span class="p">;</span>

<span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">fish</span> <span class="k">in</span> <span class="n">fishes</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">fish</span><span class="p">.</span><span class="n">colour</span> <span class="p">==</span> <span class="s">"brown"</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">brownFish</span> <span class="p">=</span> <span class="n">fish</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Can be simplified with the Linq library:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>

<span class="kt">var</span> <span class="n">brownFish</span> <span class="p">=</span> <span class="n">fishes</span><span class="p">.</span><span class="nf">First</span><span class="p">(</span><span class="n">fish</span> <span class="p">=&gt;</span> <span class="n">fish</span><span class="p">.</span><span class="n">colour</span> <span class="p">==</span> <span class="s">"brown"</span><span class="p">);</span>
</code></pre></div></div>

<p>The latter is clearly simpler, and hopefully not too difficult to understand, but its does require:</p>

<ol>
  <li>Knowledge of the Linq library</li>
  <li>An understanding of lambda expressions work</li>
</ol>

<p>I think that in this case the Linq solution is so much simpler and quite expressive enough that it should definitely be preferred - and hopefully if another developer doesn’t know about Linq, it will be quite easy for them to pick up, and will expand their knowledge.</p>

<h3 id="single-use-variables">Single-use variables</h3>

<p>While the following variable is pointless:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">arrayLength</span> <span class="o">=</span> <span class="nx">myArray</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">arrayIterator</span><span class="p">;</span> <span class="nx">arrayIterator</span> <span class="o">&lt;</span> <span class="nx">arrayLength</span><span class="p">;</span> <span class="nx">arrayIterator</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="p">...</span> <span class="p">}</span>
</code></pre></div></div>

<p>There are some cases where variables can be used to add useful semantic meaning:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">slideshowContainer</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">(</span><span class="dl">'</span><span class="s1">main&gt;.show</span><span class="dl">'</span><span class="p">);</span>

<span class="nx">slideshowContainer</span><span class="p">.</span><span class="nx">startSlideshow</span><span class="p">();</span>
</code></pre></div></div>


  
</article>

<script>
  /**
   * Document outline
   */

  // Get elements
  let article = document.querySelector("article");
  let headings = document.querySelector(".headings");
  let list = headings.querySelector("ol");

  // Populate nav
  article.querySelectorAll("h1, h2").forEach(function (heading) {
    let item = document.createElement("li");
    item.classList.add(heading.tagName.toLowerCase());
    item.innerHTML = `<a href="#${heading.id}">${heading.textContent}</a>`;
    list.appendChild(item);
  });

  function toggleHeadings() {
    // Don't show if there's not space
    if (article.offsetLeft < 180) {
      headings.style.display = "none";
      return;
    }

    // More compact layout
    if (article.offsetLeft < 350) {
      list.style.marginRight = "1.5em";
    } else {
      list.style.marginRight = "6em";
    }

    let articleBounding = article.getBoundingClientRect();
    let rightOffset = document.body.offsetWidth - articleBounding.left;

    headings.style.display = "block";
    headings.style.right = rightOffset + "px";

    if (articleBounding.top > 0) {
      headings.style.top = articleBounding.top + "px";
    } else {
      headings.style.top = 0;
    }
  }

  window.addEventListener('scroll', toggleHeadings);
  window.addEventListener('resize', toggleHeadings);

  toggleHeadings();
</script>

<address class="author">
  By <a href="https://twitter.com/nottrobin">@nottrobin</a>
</address>





<nav class="more-posts">
  <h2>More posts</h2>
  
  <p>
    <a href="/blogging-from-my-phone-with-gitjournal">Blogging from my phone with GitJournal</a><br>
    <time datetime="2022-06-05">5th June 2022</time>
  </p>
  
  
  <p>
    <a href="/i-will-want-to-be-with-my-baby">I will want to be with my baby</a><br>
    <time datetime="2013-11-29">29th November 2013</time>
  </p>
  
  
  <p>
    <a href="/how-to-secure-your-site-against-the-nsa">How to secure your site against the NSA and GCHQ</a><br>
    <time datetime="2013-11-07">7th November 2013</time>
  </p>
  
</nav>


  <footer class="see-the-code">
    <a href="https://github.com/nottrobin/robinwinslow.uk">☵ See the code</a>
  </footer>

  <!-- Instant.page -->
  <script>
    let mouseoverTimer; let lastTouchTimestamp; const prefetches = new Set; const prefetchElement = document.createElement("link"); const isSupported = prefetchElement.relList && prefetchElement.relList.supports && prefetchElement.relList.supports("prefetch") && window.IntersectionObserver && "isIntersecting" in IntersectionObserverEntry.prototype; const allowQueryString = "instantAllowQueryString" in document.body.dataset; const allowExternalLinks = "instantAllowExternalLinks" in document.body.dataset; const useWhitelist = "instantWhitelist" in document.body.dataset; const mousedownShortcut = "instantMousedownShortcut" in document.body.dataset; const DELAY_TO_NOT_BE_CONSIDERED_A_TOUCH_INITIATED_ACTION = 1111; let delayOnHover = 65; let useMousedown = false; let useMousedownOnly = false; let useViewport = false; if ("instantIntensity" in document.body.dataset) { const intensity = document.body.dataset.instantIntensity; if (intensity.substr(0, "mousedown".length) == "mousedown") { useMousedown = true; if (intensity == "mousedown-only") { useMousedownOnly = true } } else if (intensity.substr(0, "viewport".length) == "viewport") { if (!(navigator.connection && (navigator.connection.saveData || navigator.connection.effectiveType && navigator.connection.effectiveType.includes("2g")))) { if (intensity == "viewport") { if (document.documentElement.clientWidth * document.documentElement.clientHeight < 45e4) { useViewport = true } } else if (intensity == "viewport-all") { useViewport = true } } } else { const milliseconds = parseInt(intensity); if (!isNaN(milliseconds)) { delayOnHover = milliseconds } } } if (isSupported) { const eventListenersOptions = { capture: true, passive: true }; if (!useMousedownOnly) { document.addEventListener("touchstart", touchstartListener, eventListenersOptions) } if (!useMousedown) { document.addEventListener("mouseover", mouseoverListener, eventListenersOptions) } else if (!mousedownShortcut) { document.addEventListener("mousedown", mousedownListener, eventListenersOptions) } if (mousedownShortcut) { document.addEventListener("mousedown", mousedownShortcutListener, eventListenersOptions) } if (useViewport) { let triggeringFunction; if (window.requestIdleCallback) { triggeringFunction = (callback => { requestIdleCallback(callback, { timeout: 1500 }) }) } else { triggeringFunction = (callback => { callback() }) } triggeringFunction(() => { const intersectionObserver = new IntersectionObserver(entries => { entries.forEach(entry => { if (entry.isIntersecting) { const linkElement = entry.target; intersectionObserver.unobserve(linkElement); preload(linkElement.href) } }) }); document.querySelectorAll("a").forEach(linkElement => { if (isPreloadable(linkElement)) { intersectionObserver.observe(linkElement) } }) }) } } function touchstartListener(event) { lastTouchTimestamp = performance.now(); const linkElement = event.target.closest("a"); if (!isPreloadable(linkElement)) { return } preload(linkElement.href) } function mouseoverListener(event) { if (performance.now() - lastTouchTimestamp < DELAY_TO_NOT_BE_CONSIDERED_A_TOUCH_INITIATED_ACTION) { return } const linkElement = event.target.closest("a"); if (!isPreloadable(linkElement)) { return } linkElement.addEventListener("mouseout", mouseoutListener, { passive: true }); mouseoverTimer = setTimeout(() => { preload(linkElement.href); mouseoverTimer = undefined }, delayOnHover) } function mousedownListener(event) { const linkElement = event.target.closest("a"); if (!isPreloadable(linkElement)) { return } preload(linkElement.href) } function mouseoutListener(event) { if (event.relatedTarget && event.target.closest("a") == event.relatedTarget.closest("a")) { return } if (mouseoverTimer) { clearTimeout(mouseoverTimer); mouseoverTimer = undefined } } function mousedownShortcutListener(event) { if (performance.now() - lastTouchTimestamp < DELAY_TO_NOT_BE_CONSIDERED_A_TOUCH_INITIATED_ACTION) { return } const linkElement = event.target.closest("a"); if (event.which > 1 || event.metaKey || event.ctrlKey) { return } if (!linkElement) { return } linkElement.addEventListener("click", function (event) { if (event.detail == 1337) { return } event.preventDefault() }, { capture: true, passive: false, once: true }); const customEvent = new MouseEvent("click", { view: window, bubbles: true, cancelable: false, detail: 1337 }); linkElement.dispatchEvent(customEvent) } function isPreloadable(linkElement) { if (!linkElement || !linkElement.href) { return } if (useWhitelist && !("instant" in linkElement.dataset)) { return } if (!allowExternalLinks && linkElement.origin != location.origin && !("instant" in linkElement.dataset)) { return } if (!["http:", "https:"].includes(linkElement.protocol)) { return } if (linkElement.protocol == "http:" && location.protocol == "https:") { return } if (!allowQueryString && linkElement.search && !("instant" in linkElement.dataset)) { return } if (linkElement.hash && linkElement.pathname + linkElement.search == location.pathname + location.search) { return } if ("noInstant" in linkElement.dataset) { return } return true } function preload(url) { if (prefetches.has(url)) { return } const prefetcher = document.createElement("link"); prefetcher.rel = "prefetch"; prefetcher.href = url; document.head.appendChild(prefetcher); prefetches.add(url) }
  </script>
</body>

</html>
