<!doctype html>

<!--
## Features:

- Keep CSS inline: It will be small enough not to add much weight to the page, which means it's better to avoid the extra HTTP call to request CSS
- Use system fonts: But it's hard to find a nice system font for both Linux, Windows and MacOS

- Google colours for links
- Visual box around article to highlight it
- Navigation - don't get in the way
- 

JavaScript:

- Only use enhancements that aren't necessary:
  - Document outline on the left
  - Add "title" to links

-->

<html lang="en">

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>How to host your static site with HTTPS on GitHub Pages and CloudFlare</title>

  <meta name="description" content="The combination of the free services from CloudFlare and Github Pages make it incredibly easy to host a secure website.">

  <!-- Social media -->
  <meta property='article:author' content='https://twitter.com/nottrobin' />
  <meta property='article:publisher' content='https://robinwinslow.uk' />
  <meta property="og:image" content="https://www.thebluediamondgallery.com/tablet/images/blog.jpg" />
  <meta property="og:url" content="https://robinwinslow.uk/free-https-custom-hosting" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="How to host your static site with HTTPS on GitHub Pages and CloudFlare" />
  <!-- Keep Terry Pratchett alive in the network https://xclacksoverhead.org/home/about -->
  <meta http-equiv="x-clacks-overhead" content="GNU Terry Pratchett" />

  <link type="application/atom+xml" rel="alternative" href="/rss.xml" />

  <style>
    /**
       * Font size
       * 
       * For usability, bigger text is almost always better. People continue to Especially as resolutions get higher
       * 
       */

    body {
      font-family: "dejavu Sans light", sans-serif;
      font-size: 1.5rem;
      background-color: #efefef;
      margin: 0;
    }

    time,
    .subtitle {
      color: #767676;
    }

    h1,
    h2,
    h3,
    h4 {
      font-weight: normal;
      margin-top: 2em;
      margin-bottom: 1em;
    }

    h1 {
      font-size: 2em;
    }

    h2 {
      font-size: 1.5em;
    }

    h3 {
      font-size: 1.2em;
    }

    h4 {
      font-size: 1.1em;
    }

    p {
      line-height: 1.5em;
    }

    a {
      color: #1a0dab;
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    a:visited {
      color: #551A8B;
    }

    input,
    button {
      appearance: none;
      border: 1px solid lightgray;
      font-size: 1em;
      max-width: 100%;
      padding: 0.5em 0.8em;
    }

    article {
      margin: auto;
      padding: 3em 5em;
      max-width: 35em;
      background-color: white;
    }

    @media (max-width: 1080px) {
      article {
        padding: 0.5em 1.5em;
      }
    }

    article p,
    article ul,
    article ol {
      margin-block-start: 1.5em;
      margin-block-end: 1.5em;
    }

    article li {
      margin-block-start: 1em;
      margin-block-end: 1em;
      line-height: 1.5em;
    }

    blockquote {
      padding: 1em 1.5em;
      margin: 1.5em 0;
      border-left: 2px solid #ddd;
      font-style: italic;
    }

    blockquote p {
      display: inline;
    }

    pre {
      overflow-x: auto;
      background-color: #eee;
      padding: 1em;
      line-height: 125%;
    }

    img {
      max-width: 100%;
    }

    code {
      padding: 0.125em 0.25em;
      line-height: 1.6em;
      margin: 0;
      font-size: 0.8em;
      background-color: #f0f0f0;
      border-radius: 6px;
    }

    pre code {
      line-height: inherit;
      padding: 0;
    }

    hr {
      margin: 3em 0;
    }

    /* Classes */
    .article-header {
      margin: auto;
      max-width: 60em;
      padding: 3em 1em;
      text-align: center;
    }

    .article-header h1 {
      font-size: 3em;
      margin: 0 0 0.5em 0;
    }

    @media (max-width: 1080px) {
      .article-header h1 {
        font-size: 2.3em;
      }
    }

    .back-to-home {
      padding: 0 1.5em;
    }

    .title {
      text-align: center;
      margin: 1em 1em 2em 1em;
    }

    .title h1 {
      margin-bottom: 0;
    }

    .title p {
      margin-top: 0.25em;
    }

    .search-form {
      text-align: center;
      margin: 0.8em 1em;
    }

    .search-form input,
    .search-form button {
      margin: 0.2em 0;
    }

    .posts li {
      margin: 3em 0;
    }

    .posts li article {
      padding: 0.5em 3em;
    }

    .posts li article .date {
      margin-top: 0.5em;
      font-size: 0.8em;
    }

    @media (max-width: 984px) {
      .posts li article {
        padding: 1.5em;
      }
    }

    .posts li article h1 {
      font-size: 1.5em;
      margin: 1em 0 0 0;
      font-weight: normal;
    }

    @media (max-width: 984px) {
      .posts li article h1 {
        font-size: 1.3em;
      }
    }

    .posts {
      padding: 0;
      margin: 0;
      list-style-type: none;
    }

    .see-the-code {
      padding: 1.5em;
      font-size: 0.8em;
      text-align: right;
    }

    .discuss {
      text-align: center;
      font-style: italic;
    }

    .author {
      text-align: center;
      margin: 3em;
      font-style: normal;
    }

    .more-posts {
      padding: 1.5em 3em;
      margin: auto;
      background-color: white;
      max-width: 35em;
    }

    .more-posts h2 {
      margin-top: 1em;
    }

    .more-posts time {
      font-size: 0.8em;
    }

    .headings {
      position: absolute;
      text-align: right;
      font-size: 0.8em;
      opacity: 0.5;
      position: fixed;
      display: none;
    }

    .headings ol {
      margin: 6em 6em 1.5em 1.5em;
      padding: 0;
    }

    .headings ol li {
      list-style-type: none;
      margin: 1.5em 0 0 0;
    }

    .headings ol li.h2 {
      font-size: 0.8em;
      opacity: 0.8;
      margin: 0.7em 0 0 0;
    }

    .heading-link {
      opacity: 0.4;
      font-size: 2rem;
    }

    table {
      border-spacing: 0;
      font-size: 0.8em;
    }

    td {
      padding: 1em;
      border-left: 1px dotted #666;
      border-top: 1px dotted #666;
    }

    td:last-child {
      border-right: 1px dotted #666;
    }

    tr:last-child td {
      border-bottom: 1px dotted #666;
    }

    /* Pygments syntax highlighting autumn theme */
    td.linenos pre {
      color: #000000;
      background-color: #f0f0f0;
      padding-left: 5px;
      padding-right: 5px;
    }

    span.linenos {
      color: #000000;
      background-color: #f0f0f0;
      padding-left: 5px;
      padding-right: 5px;
    }

    td.linenos pre.special {
      color: #000000;
      background-color: #ffffc0;
      padding-left: 5px;
      padding-right: 5px;
    }

    span.linenos.special {
      color: #000000;
      background-color: #ffffc0;
      padding-left: 5px;
      padding-right: 5px;
    }

    .highlight .hll {
      background-color: #ffffcc
    }

    .highlight {
      background: #f0f0f0;
    }

    .highlight .c {
      color: #60a0b0;
      font-style: italic
    }

    .highlight .err {
      border: 1px solid #FF0000
    }

    .highlight .k {
      color: #007020;
      font-weight: bold
    }

    .highlight .o {
      color: #666666
    }

    .highlight .ch {
      color: #60a0b0;
      font-style: italic
    }

    .highlight .cm {
      color: #60a0b0;
      font-style: italic
    }

    .highlight .cp {
      color: #007020
    }

    .highlight .cpf {
      color: #60a0b0;
      font-style: italic
    }

    .highlight .c1 {
      color: #60a0b0;
      font-style: italic
    }

    .highlight .cs {
      color: #60a0b0;
      background-color: #fff0f0
    }

    .highlight .gd {
      color: #A00000
    }

    .highlight .ge {
      font-style: italic
    }

    .highlight .gr {
      color: #FF0000
    }

    .highlight .gh {
      color: #000080;
      font-weight: bold
    }

    .highlight .gi {
      color: #00A000
    }

    .highlight .go {
      color: #888888
    }

    .highlight .gp {
      color: #c65d09;
      font-weight: bold
    }

    .highlight .gs {
      font-weight: bold
    }

    .highlight .gu {
      color: #800080;
      font-weight: bold
    }

    .highlight .gt {
      color: #0044DD
    }

    .highlight .kc {
      color: #007020;
      font-weight: bold
    }

    .highlight .kd {
      color: #007020;
      font-weight: bold
    }

    .highlight .kn {
      color: #007020;
      font-weight: bold
    }

    .highlight .kp {
      color: #007020
    }

    .highlight .kr {
      color: #007020;
      font-weight: bold
    }

    .highlight .kt {
      color: #902000
    }

    .highlight .m {
      color: #40a070
    }

    .highlight .s {
      color: #4070a0
    }

    .highlight .na {
      color: #4070a0
    }

    .highlight .nb {
      color: #007020
    }

    .highlight .nc {
      color: #0e84b5;
      font-weight: bold
    }

    .highlight .no {
      color: #60add5
    }

    .highlight .nd {
      color: #555555;
      font-weight: bold
    }

    .highlight .ni {
      color: #d55537;
      font-weight: bold
    }

    .highlight .ne {
      color: #007020
    }

    .highlight .nf {
      color: #06287e
    }

    .highlight .nl {
      color: #002070;
      font-weight: bold
    }

    .highlight .nn {
      color: #0e84b5;
      font-weight: bold
    }

    .highlight .nt {
      color: #062873;
      font-weight: bold
    }

    .highlight .nv {
      color: #bb60d5
    }

    .highlight .ow {
      color: #007020;
      font-weight: bold
    }

    .highlight .w {
      color: #bbbbbb
    }

    .highlight .mb {
      color: #40a070
    }

    .highlight .mf {
      color: #40a070
    }

    .highlight .mh {
      color: #40a070
    }

    .highlight .mi {
      color: #40a070
    }

    .highlight .mo {
      color: #40a070
    }

    .highlight .sa {
      color: #4070a0
    }

    .highlight .sb {
      color: #4070a0
    }

    .highlight .sc {
      color: #4070a0
    }

    .highlight .dl {
      color: #4070a0
    }

    .highlight .sd {
      color: #4070a0;
      font-style: italic
    }

    .highlight .s2 {
      color: #4070a0
    }

    .highlight .se {
      color: #4070a0;
      font-weight: bold
    }

    .highlight .sh {
      color: #4070a0
    }

    .highlight .si {
      color: #70a0d0;
      font-style: italic
    }

    .highlight .sx {
      color: #c65d09
    }

    .highlight .sr {
      color: #235388
    }

    .highlight .s1 {
      color: #4070a0
    }

    .highlight .ss {
      color: #517918
    }

    .highlight .bp {
      color: #007020
    }

    .highlight .fm {
      color: #06287e
    }

    .highlight .vc {
      color: #bb60d5
    }

    .highlight .vg {
      color: #bb60d5
    }

    .highlight .vi {
      color: #bb60d5
    }

    .highlight .vm {
      color: #bb60d5
    }

    .highlight .il {
      color: #40a070
    }
  </style>
</head>

<body>
  <nav class="back-to-home">
  <p><a href="/">← Posts</a></h1></p>
</nav>

<header class="article-header">
  <h1>How to host your static site with HTTPS on GitHub Pages and CloudFlare</h1>
  <time datetime="2016-02-12">12th February 2016</time>
</header>

<nav class="headings">
  <ol>
    <li><a href="#top">↑ top</a></li>
  </ol>
</nav>

<article>
  <p>There has been a <a href="https://www.chapterthree.com/blog/why-your-site-should-be-using-https" title="Why your site should be using HTTPS">growing</a> <a href="https://www.youtube.com/watch?v=cBhZ6S0PFCY" title="Google I/O 2014 - HTTPS Everywhere">movement</a> to get all websites to use SSL
connections where possible. Nowadays, Google even <a href="https://googlewebmastercentral.blogspot.co.uk/2014/08/https-as-ranking-signal.html" title="Google Webmaster Central Blog: HTTPS as a ranking signal">uses it as a criterion</a> for
ranking websites.</p>

<p>I’ve written before about <a href="/2014/08/26/host-your-site-with-https-for-free/" title="Robin Winslow: Host your site with HTTPS for free">how to host an HTTPS website for free with StartSSL
and OpenShift</a>. However, StartSSL is very hard to use and provides
very basic certificates, and setting up a website on OpenShift is a fairly technical
undertaking.</p>

<p>There now exists <a href="https://sheharyar.me/blog/free-ssl-for-github-pages-with-custom-domains/" title="Sheharyar Naseer: Set Up SSL on Github Pages With Custom Domains for Free">a much simpler way to setup an HTTPS website</a> with
<a href="https://www.cloudflare.com/" title="CloudFlare is a free global CDN and DNS provider that can speed up and protect any site online">CloudFlare</a> and <a href="https://pages.github.com/" title="Github Pages: Websites for you and your projects">GitHub Pages</a>. This only works for static sites.</p>

<p>If your site is more complicated and needs a database or dynamic functionality,
or you need an SHA-1 fallback certificate (explained below)
then look at my other post about <a href="/2014/08/26/host-your-site-with-https-for-free/" title="Robin Winslow: Host your site with HTTPS for free">the OpenShift solution</a>. However,
if a static site works for you, read on.</p>

<h2 id="github-pages">GitHub Pages</h2>

<p>As most developers will be aware by now, GitHub offer a fantastic free
static website hosting solution in <a href="https://pages.github.com/" title="Github Pages: Websites for you and your projects">GitHub Pages</a>.</p>

<p>All you have to do is <a href="https://help.github.com/articles/creating-project-pages-manually/" title="GitHub help: Creating Project Pages manually">put your HTML files in the <code class="language-plaintext highlighter-rouge">gh-pages</code> branch</a> of one of
your repositories and they will be served as a website at
<code class="language-plaintext highlighter-rouge">{username}.github.io/{project-name}</code>.</p>

<p><img src="http://i.imgur.com/DBeJSBN.png" alt="GitHub pages minimal files" /></p>

<p>And all files are passed through the
<a href="https://jekyllrb.com/" title="Jekyll: Transform your plain text into static websites and blogs.">Jekyll</a> parser first, so if you want to split up your HTML into templates
you can. And if you don’t want to craft your site by hand, you can use the
<a href="https://github.com/blog/1081-instantly-beautiful-project-pages" title="GitHub: Instantly Beautiful Project Pages">Automatic Page Generator</a>.</p>

<p><img src="https://camo.githubusercontent.com/d60800ddc54bf9d0317ca901e7fb14590167f7fd/68747470733a2f2f6769746875622d696d616765732e73332e616d617a6f6e6177732e636f6d2f626c6f672f323031322f706167652d67656e657261746f722d7069636b65722e706e67" alt="automatic page generator themes" /></p>

<p>Websites on <code class="language-plaintext highlighter-rouge">github.io</code> also <a href="https://konklone.com/post/github-pages-now-sorta-supports-https-so-use-it" title="Eric Mill: GitHub Pages Now (Sorta) Supports HTTPS, So Use It">support HTTPS</a>, so you can serve your site up
at <code class="language-plaintext highlighter-rouge">https://{username}.github.io/{project-name}</code> if you want.</p>

<p><img src="http://i.imgur.com/2ZvKJEP.png" alt="mytestwebsite GitHub pages" /></p>

<p>GitHub Pages also <a href="https://help.github.com/articles/setting-up-a-custom-domain-with-github-pages/" title="GitHub help: Setting up a custom domain with GitHub Pages">support custom domains</a> (still for free). Just add a <code class="language-plaintext highlighter-rouge">CNAME</code>
file to the repository with your domain name in it - e.g.
<code class="language-plaintext highlighter-rouge">mytestwebsite.robinwinslow.uk</code> - and then go and setup the <a href="https://en.wikipedia.org/wiki/CNAME_record" title="Wikipedia: CNAME record">DNS CNAME</a>
to point to <code class="language-plaintext highlighter-rouge">{username}.github.io</code>.</p>

<p><img src="http://i.imgur.com/7EF2uwyg.png" alt="mytestwebsite GitHub pages files" /></p>

<p>The only thing you can’t do directly with GitHub Pages is offer HTTPS
on your custom domain - e.g. <code class="language-plaintext highlighter-rouge">https://mytestwebsite.robinwinslow.uk</code>. This is where
CloudFlare comes in.</p>

<h2 id="cloudflare">CloudFlare</h2>

<p>CloudFlare offer a really quite impressive free DNS and CDN service. This free
service includes some really impressive offerings, the first three of which
are especially helpful for our current HTTPS mission:</p>

<ul>
  <li><a href="https://blog.cloudflare.com/introducing-universal-ssl/" title="CloudFlare: Introducing Universal SSL">Free automatic HTTPS for your domain</a> - no need to buy a certificate</li>
  <li><a href="https://support.cloudflare.com/hc/en-us/articles/200168306-Is-there-a-tutorial-for-Page-Rules-" title="CloudFlare support: Is there a tutorial for Page Rules?">Page Rules</a> - custom settings and redirects for URL patterns</li>
  <li><a href="https://blog.cloudflare.com/enforce-web-policy-with-hypertext-strict-transport-security-hsts/" title="CloudFlare: Enforce Web Policy with HTTP Strict Transport Security (HSTS)">HTTP Strict Transport Security</a> (HSTS) - protection from <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack" title="Wikipedia: Man-in-the-middle attack">MITM attacks</a></li>
  <li><a href="https://www.cloudflare.com/dnssec/universal-dnssec/" title="CloudFlare Universal DNSSEC">DNSSEC</a> - protection from DNS poisoning attacks</li>
  <li><a href="https://www.cloudflare.com/http2/" title="CloudFlare HTTP/2">HTTP/2</a> - optimised connections for browsers that support it</li>
  <li><a href="https://blog.cloudflare.com/introducing-cname-flattening-rfc-compliant-cnames-at-a-domains-root/" title="CloudFlare: Introducing CNAME Flattening: RFC-Compliant CNAMEs at a Domain's Root">CNAME flattening</a> - so you can use a <a href="https://en.wikipedia.org/wiki/CNAME_record" title="Wikipedia: CNAME record">DNS CNAME</a> at the domain apex</li>
  <li><a href="https://www.cloudflare.com/always-online/" title="CloudFlare: Always Online™">“Always online” protection</a> - Your cached website will stay up even if the host goes down</li>
  <li><a href="https://www.cloudflare.com/features-security/" title="CloudFlare: Security">Firewall</a> - intelligent protection against <a href="https://en.wikipedia.org/wiki/Denial-of-service_attack" title="Wikipedia: Denial-of-service attack">DDOS attacks</a></li>
</ul>

<p>The most important downside to CloudFlare’s free tier SSL is that it doesn’t
include the <a href="https://blog.cloudflare.com/sha-1-deprecation-no-browser-left-behind/" title="CloudFlare blog: SHA-1 Deprecation: No Browser Left Behind">fall-back to legacy SHA-1 for older browsers</a>.
This means that the most out-of-date (and therefore probably the poorest) 1.5%
of global citizens won’t be able to access your site without upgrading their
browser. If this is important to you, either find a different HTTPS solution or
upgrade to a <a href="https://www.cloudflare.com/plans/" title="CloudFlare: Plans">paid CloudFlare account</a>.</p>

<h3 id="setting-up-https">Setting up HTTPS</h3>

<p>Because CloudFlare are a CDN <em>and</em> a DNS host, they can do the HTTPS negotiation
for you. They’ve taken advantage of this to provide you with a free HTTPS
certificate to encrypt communication between your users and their cached site.</p>

<p>First simply setup your DNS with CloudFlare to point to <code class="language-plaintext highlighter-rouge">{username}.github.io</code>,
and allow CloudFlare to cache the site.</p>

<p><img src="http://i.imgur.com/VxPqzgFg.png" alt="mytestwebsite CloudFlare DNS setup" /></p>

<p>Between CloudFlare and your host the connection doesn’t have to be encrypted,
but I would certainly suggest that it still should be. But crucially for us,
this encrypted connection doesn’t actually need a <em>valid</em> HTTPS certificate. To
enable this we should select the “Full” (rather than “Flexible” or “Strict”)
option.</p>

<p><img src="http://i.imgur.com/olf2JH2g.png" alt="CloudFlare full SSL encryption" /></p>

<p>Et voilà! You now have an encrypted custom domain in front of
GitHub Pages completely for free!</p>

<p><img src="http://i.imgur.com/eBgFJqp.png" alt="mytestwebsite with a secure domain" /></p>

<h2 id="ensuring-all-visitors-use-https">Ensuring all visitors use HTTPS</h2>

<p>To make our site properly secure, we need to ensure all users are sent
to the HTTPS site (<code class="language-plaintext highlighter-rouge">https://mytestwebsite.robinwinslow.uk</code>) instead of the HTTP
one (<code class="language-plaintext highlighter-rouge">http://mytestwebsite.robinwinslow.uk</code>).</p>

<h3 id="setting-up-a-page-rule">Setting up a page rule</h3>

<p>The first step to get visitors to use HTTPS is to send a <a href="https://moz.com/learn/seo/redirection" title="MOZ: Redirection">301 redirect</a>
from <code class="language-plaintext highlighter-rouge">http://mytestwebsite.robinwinslow.uk</code> to <code class="language-plaintext highlighter-rouge">https://mytestwebsite.robinwinslow.uk</code>.</p>

<p>Although this is not supported with GitHub Pages, it <a href="https://support.cloudflare.com/hc/en-us/articles/200170536-How-do-I-redirect-all-visitors-to-HTTPS-SSL-" title="CloudFlare support: How do I redirect all visitors to HTTPS/SSL?">can be achieved</a> with
CloudFlare page rules.</p>

<p>Just add a page rule for <code class="language-plaintext highlighter-rouge">http://*{your-domain.com}/*</code> (e.g. <code class="language-plaintext highlighter-rouge">http://*robinwinslow.uk/*</code>)
and turn on “Always use HTTPS”:</p>

<p><img src="http://i.imgur.com/1l6tyIAg.png" alt="CloudFlare always use HTTPS page rule" /></p>

<p>Now we can check that our domain is redirecting users to HTTPS
by inspecting the headers:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-I</span> mytestwebsite.robinwinslow.uk
HTTP/1.1 301 Moved Permanently
...
Location: https://mytestwebsite.robinwinslow.uk/
</code></pre></div></div>

<h3 id="http-strict-transport-security-hsts">HTTP Strict Transport Security (HSTS)</h3>

<p>To protect our users from <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack" title="Wikipedia: Man-in-the-middle attack">man-in-the-middle attacks</a>, we should also
turn on <a href="https://blog.cloudflare.com/enforce-web-policy-with-hypertext-strict-transport-security-hsts/" title="CloudFlare blog: Enforce Web Policy with HTTP Strict Transport Security (HSTS)">HSTS with CloudFlare</a> (still for free). Note that this can cause
problems if you’re ever planning on removing HTTPS from your site.</p>

<p>If you’re using a subdomain (e.g. <code class="language-plaintext highlighter-rouge">mytestwebsite.robinwinslow.uk</code>),
remember to enable “Apply HSTS policy to subdomains”.</p>

<p><img src="http://i.imgur.com/tYam5yng.png" alt="CloudFlare: HSTS setting" /></p>

<p>This will tell <a href="http://caniuse.com/#feat=stricttransportsecurity" title="Can I use... Strict Transport Security">modern browsers</a> to always use the HTTPS protocol for this domain.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-I</span> https://mytestwebsite.robinwinslow.uk
HTTP/1.1 200 OK
...
Strict-Transport-Security: max-age<span class="o">=</span>15552000<span class="p">;</span> includeSubDomains<span class="p">;</span> preload
X-Content-Type-Options: nosniff
</code></pre></div></div>

<p>It can take several weeks for your domain to make it into the
<a href="https://hstspreload.appspot.com/" title="Chromium HSTS preload list">Chromium HSTS preload list</a>. You can check if it’s in there, or add it
again, by visiting <code class="language-plaintext highlighter-rouge">chrome://net-internals/#hsts</code> in a Chrome or Chromium
browser and looking for the <code class="language-plaintext highlighter-rouge">static_sts_domain</code> setting.</p>

<h2 id="thats-it">That’s it!</h2>

<p>You now have an incredibly quick and easy way to put a fully secure website
online in minutes, totally for free!</p>



  
</article>

<script>
  /**
   * Document outline
   */

  // Get elements
  let article = document.querySelector("article");
  let headings = document.querySelector(".headings");
  let list = headings.querySelector("ol");

  // Populate nav
  article.querySelectorAll("h1, h2").forEach(function (heading) {
    let item = document.createElement("li");
    item.classList.add(heading.tagName.toLowerCase());
    item.innerHTML = `<a href="#${heading.id}">${heading.textContent}</a>`;
    list.appendChild(item);
  });

  function toggleHeadings() {
    // Don't show if there's not space
    if (article.offsetLeft < 180) {
      headings.style.display = "none";
      return;
    }

    // More compact layout
    if (article.offsetLeft < 350) {
      list.style.marginRight = "1.5em";
    } else {
      list.style.marginRight = "6em";
    }

    let articleBounding = article.getBoundingClientRect();
    let rightOffset = document.body.offsetWidth - articleBounding.left;

    headings.style.display = "block";
    headings.style.right = rightOffset + "px";

    if (articleBounding.top > 0) {
      headings.style.top = articleBounding.top + "px";
    } else {
      headings.style.top = 0;
    }
  }

  window.addEventListener('scroll', toggleHeadings);
  window.addEventListener('resize', toggleHeadings);

  toggleHeadings();
</script>

<address class="author">
  By <a href="https://twitter.com/nottrobin">@nottrobin</a>
</address>





<nav class="more-posts">
  <h2>More posts</h2>
  
  <p>
    <a href="/blogging-from-my-phone-with-gitjournal">Blogging from my phone with GitJournal</a><br>
    <time datetime="2022-06-05">5th June 2022</time>
  </p>
  
  
  <p>
    <a href="/simplest-wsgi-application">Creating a minimal Python application server for experimenting</a><br>
    <time datetime="2016-02-13">13th February 2016</time>
  </p>
  
  
  <p>
    <a href="/discipline">Gaining discipline</a><br>
    <time datetime="2015-12-31">31st December 2015</time>
  </p>
  
</nav>


  <footer class="see-the-code">
    <a href="https://github.com/nottrobin/robinwinslow.uk">☵ See the code</a>
  </footer>

  <!-- Instant.page -->
  <script>
    let mouseoverTimer; let lastTouchTimestamp; const prefetches = new Set; const prefetchElement = document.createElement("link"); const isSupported = prefetchElement.relList && prefetchElement.relList.supports && prefetchElement.relList.supports("prefetch") && window.IntersectionObserver && "isIntersecting" in IntersectionObserverEntry.prototype; const allowQueryString = "instantAllowQueryString" in document.body.dataset; const allowExternalLinks = "instantAllowExternalLinks" in document.body.dataset; const useWhitelist = "instantWhitelist" in document.body.dataset; const mousedownShortcut = "instantMousedownShortcut" in document.body.dataset; const DELAY_TO_NOT_BE_CONSIDERED_A_TOUCH_INITIATED_ACTION = 1111; let delayOnHover = 65; let useMousedown = false; let useMousedownOnly = false; let useViewport = false; if ("instantIntensity" in document.body.dataset) { const intensity = document.body.dataset.instantIntensity; if (intensity.substr(0, "mousedown".length) == "mousedown") { useMousedown = true; if (intensity == "mousedown-only") { useMousedownOnly = true } } else if (intensity.substr(0, "viewport".length) == "viewport") { if (!(navigator.connection && (navigator.connection.saveData || navigator.connection.effectiveType && navigator.connection.effectiveType.includes("2g")))) { if (intensity == "viewport") { if (document.documentElement.clientWidth * document.documentElement.clientHeight < 45e4) { useViewport = true } } else if (intensity == "viewport-all") { useViewport = true } } } else { const milliseconds = parseInt(intensity); if (!isNaN(milliseconds)) { delayOnHover = milliseconds } } } if (isSupported) { const eventListenersOptions = { capture: true, passive: true }; if (!useMousedownOnly) { document.addEventListener("touchstart", touchstartListener, eventListenersOptions) } if (!useMousedown) { document.addEventListener("mouseover", mouseoverListener, eventListenersOptions) } else if (!mousedownShortcut) { document.addEventListener("mousedown", mousedownListener, eventListenersOptions) } if (mousedownShortcut) { document.addEventListener("mousedown", mousedownShortcutListener, eventListenersOptions) } if (useViewport) { let triggeringFunction; if (window.requestIdleCallback) { triggeringFunction = (callback => { requestIdleCallback(callback, { timeout: 1500 }) }) } else { triggeringFunction = (callback => { callback() }) } triggeringFunction(() => { const intersectionObserver = new IntersectionObserver(entries => { entries.forEach(entry => { if (entry.isIntersecting) { const linkElement = entry.target; intersectionObserver.unobserve(linkElement); preload(linkElement.href) } }) }); document.querySelectorAll("a").forEach(linkElement => { if (isPreloadable(linkElement)) { intersectionObserver.observe(linkElement) } }) }) } } function touchstartListener(event) { lastTouchTimestamp = performance.now(); const linkElement = event.target.closest("a"); if (!isPreloadable(linkElement)) { return } preload(linkElement.href) } function mouseoverListener(event) { if (performance.now() - lastTouchTimestamp < DELAY_TO_NOT_BE_CONSIDERED_A_TOUCH_INITIATED_ACTION) { return } const linkElement = event.target.closest("a"); if (!isPreloadable(linkElement)) { return } linkElement.addEventListener("mouseout", mouseoutListener, { passive: true }); mouseoverTimer = setTimeout(() => { preload(linkElement.href); mouseoverTimer = undefined }, delayOnHover) } function mousedownListener(event) { const linkElement = event.target.closest("a"); if (!isPreloadable(linkElement)) { return } preload(linkElement.href) } function mouseoutListener(event) { if (event.relatedTarget && event.target.closest("a") == event.relatedTarget.closest("a")) { return } if (mouseoverTimer) { clearTimeout(mouseoverTimer); mouseoverTimer = undefined } } function mousedownShortcutListener(event) { if (performance.now() - lastTouchTimestamp < DELAY_TO_NOT_BE_CONSIDERED_A_TOUCH_INITIATED_ACTION) { return } const linkElement = event.target.closest("a"); if (event.which > 1 || event.metaKey || event.ctrlKey) { return } if (!linkElement) { return } linkElement.addEventListener("click", function (event) { if (event.detail == 1337) { return } event.preventDefault() }, { capture: true, passive: false, once: true }); const customEvent = new MouseEvent("click", { view: window, bubbles: true, cancelable: false, detail: 1337 }); linkElement.dispatchEvent(customEvent) } function isPreloadable(linkElement) { if (!linkElement || !linkElement.href) { return } if (useWhitelist && !("instant" in linkElement.dataset)) { return } if (!allowExternalLinks && linkElement.origin != location.origin && !("instant" in linkElement.dataset)) { return } if (!["http:", "https:"].includes(linkElement.protocol)) { return } if (linkElement.protocol == "http:" && location.protocol == "https:") { return } if (!allowQueryString && linkElement.search && !("instant" in linkElement.dataset)) { return } if (linkElement.hash && linkElement.pathname + linkElement.search == location.pathname + location.search) { return } if ("noInstant" in linkElement.dataset) { return } return true } function preload(url) { if (prefetches.has(url)) { return } const prefetcher = document.createElement("link"); prefetcher.rel = "prefetch"; prefetcher.href = url; document.head.appendChild(prefetcher); prefetches.add(url) }
  </script>
</body>

</html>
