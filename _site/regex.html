<!doctype html>

<!--
## Features:

- Keep CSS inline: It will be small enough not to add much weight to the page, which means it's better to avoid the extra HTTP call to request CSS
- Use system fonts: But it's hard to find a nice system font for both Linux, Windows and MacOS

- Google colours for links
- Visual box around article to highlight it
- Navigation - don't get in the way
- 

JavaScript:

- Only use enhancements that aren't necessary:
  - Document outline on the left
  - Add "title" to links

-->

<html lang="en">

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Regex basics</title>

  <meta name="description" content="An overview of regex and how to use it, from a few different angles. Including appropriate warnings like 'avoid regex'.">

  <!-- Social media -->
  <meta property='article:author' content='https://twitter.com/nottrobin' />
  <meta property='article:publisher' content='https://robinwinslow.uk' />
  <meta property="og:image" content="https://www.thebluediamondgallery.com/tablet/images/blog.jpg" />
  <meta property="og:url" content="https://robinwinslow.uk/regex" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="Regex basics" />
  <!-- Keep Terry Pratchett alive in the network https://xclacksoverhead.org/home/about -->
  <meta http-equiv="x-clacks-overhead" content="GNU Terry Pratchett" />

  <link type="application/atom+xml" rel="alternative" href="/rss.xml" />

  <style>
    /**
       * Font size
       * 
       * For usability, bigger text is almost always better. People continue to Especially as resolutions get higher
       * 
       */

    body {
      font-family: "dejavu Sans light", sans-serif;
      font-size: 1.5rem;
      background-color: #efefef;
      margin: 0;
    }

    time,
    .subtitle {
      color: #767676;
    }

    h1,
    h2,
    h3,
    h4 {
      font-weight: normal;
      margin-top: 2em;
      margin-bottom: 1em;
    }

    h1 {
      font-size: 2em;
    }

    h2 {
      font-size: 1.5em;
    }

    h3 {
      font-size: 1.2em;
    }

    h4 {
      font-size: 1.1em;
    }

    p {
      line-height: 1.5em;
    }

    a {
      color: #1a0dab;
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    a:visited {
      color: #551A8B;
    }

    input,
    button {
      appearance: none;
      border: 1px solid lightgray;
      font-size: 1em;
      max-width: 100%;
      padding: 0.5em 0.8em;
    }

    article {
      margin: auto;
      padding: 3em 5em;
      max-width: 35em;
      background-color: white;
    }

    @media (max-width: 1080px) {
      article {
        padding: 0.5em 1.5em;
      }
    }

    article p,
    article ul,
    article ol {
      margin-block-start: 1.5em;
      margin-block-end: 1.5em;
    }

    article li {
      margin-block-start: 1em;
      margin-block-end: 1em;
      line-height: 1.5em;
    }

    blockquote {
      padding: 1em 1.5em;
      margin: 1.5em 0;
      border-left: 2px solid #ddd;
      font-style: italic;
    }

    blockquote p {
      display: inline;
    }

    pre {
      overflow-x: auto;
      background-color: #eee;
      padding: 1em;
      line-height: 125%;
    }

    img {
      max-width: 100%;
    }

    code {
      padding: 0.125em 0.25em;
      line-height: 1.6em;
      margin: 0;
      font-size: 0.8em;
      background-color: #f0f0f0;
      border-radius: 6px;
    }

    pre code {
      line-height: inherit;
      padding: 0;
    }

    hr {
      margin: 3em 0;
    }

    /* Classes */
    .article-header {
      margin: auto;
      max-width: 60em;
      padding: 3em 1em;
      text-align: center;
    }

    .article-header h1 {
      font-size: 3em;
      margin: 0 0 0.5em 0;
    }

    @media (max-width: 1080px) {
      .article-header h1 {
        font-size: 2.3em;
      }
    }

    .back-to-home {
      padding: 0 1.5em;
    }

    .title {
      text-align: center;
      margin: 1em 1em 2em 1em;
    }

    .title h1 {
      margin-bottom: 0;
    }

    .title p {
      margin-top: 0.25em;
    }

    .search-form {
      text-align: center;
      margin: 0.8em 1em;
    }

    .search-form input,
    .search-form button {
      margin: 0.2em 0;
    }

    .posts li {
      margin: 3em 0;
    }

    .posts li article {
      padding: 0.5em 3em;
    }

    .posts li article .date {
      margin-top: 0.5em;
      font-size: 0.8em;
    }

    @media (max-width: 984px) {
      .posts li article {
        padding: 1.5em;
      }
    }

    .posts li article h1 {
      font-size: 1.5em;
      margin: 1em 0 0 0;
      font-weight: normal;
    }

    @media (max-width: 984px) {
      .posts li article h1 {
        font-size: 1.3em;
      }
    }

    .posts {
      padding: 0;
      margin: 0;
      list-style-type: none;
    }

    .see-the-code {
      padding: 1.5em;
      font-size: 0.8em;
      text-align: right;
    }

    .discuss {
      text-align: center;
      font-style: italic;
    }

    .author {
      text-align: center;
      margin: 3em;
      font-style: normal;
    }

    .more-posts {
      padding: 1.5em 3em;
      margin: auto;
      background-color: white;
      max-width: 35em;
    }

    .more-posts h2 {
      margin-top: 1em;
    }

    .more-posts time {
      font-size: 0.8em;
    }

    .headings {
      position: absolute;
      text-align: right;
      font-size: 0.8em;
      opacity: 0.5;
      position: fixed;
      display: none;
    }

    .headings ol {
      margin: 6em 6em 1.5em 1.5em;
      padding: 0;
    }

    .headings ol li {
      list-style-type: none;
      margin: 1.5em 0 0 0;
    }

    .headings ol li.h2 {
      font-size: 0.8em;
      opacity: 0.8;
      margin: 0.7em 0 0 0;
    }

    .heading-link {
      opacity: 0.4;
      font-size: 2rem;
    }

    table {
      border-spacing: 0;
      font-size: 0.8em;
    }

    td {
      padding: 1em;
      border-left: 1px dotted #666;
      border-top: 1px dotted #666;
    }

    td:last-child {
      border-right: 1px dotted #666;
    }

    tr:last-child td {
      border-bottom: 1px dotted #666;
    }

    /* Pygments syntax highlighting autumn theme */
    td.linenos pre {
      color: #000000;
      background-color: #f0f0f0;
      padding-left: 5px;
      padding-right: 5px;
    }

    span.linenos {
      color: #000000;
      background-color: #f0f0f0;
      padding-left: 5px;
      padding-right: 5px;
    }

    td.linenos pre.special {
      color: #000000;
      background-color: #ffffc0;
      padding-left: 5px;
      padding-right: 5px;
    }

    span.linenos.special {
      color: #000000;
      background-color: #ffffc0;
      padding-left: 5px;
      padding-right: 5px;
    }

    .highlight .hll {
      background-color: #ffffcc
    }

    .highlight {
      background: #f0f0f0;
    }

    .highlight .c {
      color: #60a0b0;
      font-style: italic
    }

    .highlight .err {
      border: 1px solid #FF0000
    }

    .highlight .k {
      color: #007020;
      font-weight: bold
    }

    .highlight .o {
      color: #666666
    }

    .highlight .ch {
      color: #60a0b0;
      font-style: italic
    }

    .highlight .cm {
      color: #60a0b0;
      font-style: italic
    }

    .highlight .cp {
      color: #007020
    }

    .highlight .cpf {
      color: #60a0b0;
      font-style: italic
    }

    .highlight .c1 {
      color: #60a0b0;
      font-style: italic
    }

    .highlight .cs {
      color: #60a0b0;
      background-color: #fff0f0
    }

    .highlight .gd {
      color: #A00000
    }

    .highlight .ge {
      font-style: italic
    }

    .highlight .gr {
      color: #FF0000
    }

    .highlight .gh {
      color: #000080;
      font-weight: bold
    }

    .highlight .gi {
      color: #00A000
    }

    .highlight .go {
      color: #888888
    }

    .highlight .gp {
      color: #c65d09;
      font-weight: bold
    }

    .highlight .gs {
      font-weight: bold
    }

    .highlight .gu {
      color: #800080;
      font-weight: bold
    }

    .highlight .gt {
      color: #0044DD
    }

    .highlight .kc {
      color: #007020;
      font-weight: bold
    }

    .highlight .kd {
      color: #007020;
      font-weight: bold
    }

    .highlight .kn {
      color: #007020;
      font-weight: bold
    }

    .highlight .kp {
      color: #007020
    }

    .highlight .kr {
      color: #007020;
      font-weight: bold
    }

    .highlight .kt {
      color: #902000
    }

    .highlight .m {
      color: #40a070
    }

    .highlight .s {
      color: #4070a0
    }

    .highlight .na {
      color: #4070a0
    }

    .highlight .nb {
      color: #007020
    }

    .highlight .nc {
      color: #0e84b5;
      font-weight: bold
    }

    .highlight .no {
      color: #60add5
    }

    .highlight .nd {
      color: #555555;
      font-weight: bold
    }

    .highlight .ni {
      color: #d55537;
      font-weight: bold
    }

    .highlight .ne {
      color: #007020
    }

    .highlight .nf {
      color: #06287e
    }

    .highlight .nl {
      color: #002070;
      font-weight: bold
    }

    .highlight .nn {
      color: #0e84b5;
      font-weight: bold
    }

    .highlight .nt {
      color: #062873;
      font-weight: bold
    }

    .highlight .nv {
      color: #bb60d5
    }

    .highlight .ow {
      color: #007020;
      font-weight: bold
    }

    .highlight .w {
      color: #bbbbbb
    }

    .highlight .mb {
      color: #40a070
    }

    .highlight .mf {
      color: #40a070
    }

    .highlight .mh {
      color: #40a070
    }

    .highlight .mi {
      color: #40a070
    }

    .highlight .mo {
      color: #40a070
    }

    .highlight .sa {
      color: #4070a0
    }

    .highlight .sb {
      color: #4070a0
    }

    .highlight .sc {
      color: #4070a0
    }

    .highlight .dl {
      color: #4070a0
    }

    .highlight .sd {
      color: #4070a0;
      font-style: italic
    }

    .highlight .s2 {
      color: #4070a0
    }

    .highlight .se {
      color: #4070a0;
      font-weight: bold
    }

    .highlight .sh {
      color: #4070a0
    }

    .highlight .si {
      color: #70a0d0;
      font-style: italic
    }

    .highlight .sx {
      color: #c65d09
    }

    .highlight .sr {
      color: #235388
    }

    .highlight .s1 {
      color: #4070a0
    }

    .highlight .ss {
      color: #517918
    }

    .highlight .bp {
      color: #007020
    }

    .highlight .fm {
      color: #06287e
    }

    .highlight .vc {
      color: #bb60d5
    }

    .highlight .vg {
      color: #bb60d5
    }

    .highlight .vi {
      color: #bb60d5
    }

    .highlight .vm {
      color: #bb60d5
    }

    .highlight .il {
      color: #40a070
    }
  </style>
</head>

<body>
  <nav class="back-to-home">
  <p><a href="/">← Posts</a></h1></p>
</nav>

<header class="article-header">
  <h1>Regex basics</h1>
  <time datetime="2021-02-17">17th February 2021</time>
</header>

<nav class="headings">
  <ol>
    <li><a href="#top">↑ top</a></li>
  </ol>
</nav>

<article>
  <p>In my team we  run “masterclasses” every couple of weeks, where someone in the team presents a topic to the rest of the team.</p>

<p>This article is basically the content of the class on regular expressions (otherwise known as regex) I gave recently.</p>

<p>It’s an introduction to the basics of regular expressions. There <a href="https://regular-expressions.mobi/quickstart.html?wlr=1">are</a> <a href="https://regexone.com/">many</a> <a href="https://www.aivosto.com/articles/regex.html">like</a> <a href="https://medium.com/better-programming/introduction-to-regex-8c18abdd4f70">it</a>, but this is mine.</p>

<h1 id="what-is-a-regular-expression-or-regex">What is a regular expression (or regex)?</h1>

<p><a href="https://en.wikipedia.org/wiki/Regular_expression">Wikipedia</a> defines regular expressions as:</p>

<blockquote>
  <p>“a sequence of characters that define a search pattern”</p>
</blockquote>

<p>They are available in basically every programming language, and you’ll probably most commonly encounter them used for string matches in conditionals that are too complicated for simple logical comparisons (like “or”, “and”, “in”).</p>

<p>A couple of examples of regular expressions to get started:</p>

<table>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">[ -~]</code></td>
      <td>Any ASCII character<br />(ASCII characters fall between space and “~”)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">^[a-z0-9_-]{3,15}$</code></td>
      <td>Usernames between 3 and 15 characters</td>
    </tr>
  </tbody>
</table>

<h1 id="when-to-use-regex">When to use regex</h1>

<p>Use regular expressions with caution. The complexity of regex carries a cost.</p>

<h2 id="avoid-coding-in-regex-if-you-can">Avoid coding in regex if you can</h2>

<blockquote>
  <p>‘Some people, when confronted with a problem, think “I know, I’ll use regular expressions.” <a href="https://blog.codinghorror.com/regular-expressions-now-you-have-two-problems/">Now they have two problems</a>.’ - Jamie Zawinski</p>
</blockquote>

<p>In programming, only use regular expressions as a last resort. Don’t solve important problems with regex.</p>

<ul>
  <li><a href="https://www.loggly.com/blog/regexes-the-bad-better-best/">regex is expensive</a> - regex is often the most CPU-intensive part of a program. And a non-matching regex can be even more expensive to check than a matching one.</li>
  <li><a href="https://github.com/canonical-web-and-design/ubuntu.com/issues/9028#issuecomment-760859952">regex is greedy</a> - It’s extremely easy to match much more than intended, leading to bugs. We have multiple times had problems with regexes being too greedy, causing issues in our sites.</li>
  <li><a href="https://blog.codinghorror.com/regular-expressions-now-you-have-two-problems/">regex is opaque</a> - Even people who know regex well will take a while to pick apart a new regex string, and are still likely to make mistakes. This has a huge cost to project maintenance in the long run. (Check out this amazing <a href="https://blog.codinghorror.com/regex-use-vs-regex-abuse/">regex for RFC822 email addresses</a>)</li>
</ul>

<p>Always try to be aware of all the language features at your disposal for operating on and checking strings, that could help you avoid regular expressions. <a href="https://www.codecademy.com/learn/learn-python-3/modules/learn-python3-strings/cheatsheet">In Python</a>, for example, the <code class="language-plaintext highlighter-rouge">in</code> keyword, the powerful <code class="language-plaintext highlighter-rouge">[]</code> indexing, and string methods like <code class="language-plaintext highlighter-rouge">contains</code> and <code class="language-plaintext highlighter-rouge">startswith</code> (which can be fed either strings or tuples for multiple values) can be combined very effectively.</p>

<p>Most importantly, regexes should not be used for <em>parsing</em> <em>strings</em>. You should instead use or write a <a href="https://medium.com/the-mighty-programmer/what-is-parsing-4012f997d265">bespoke parser</a>. For example, <a href="https://stackoverflow.com/a/1732454">you can’t parse HTML with regex</a> (in Python, use <a href="https://pypi.org/project/beautifulsoup4/">BeautifulSoup</a>; in JavaScript, use <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model/Introduction">the DOM</a>).</p>

<h2 id="when-to-code-in-regex">When to code in regex</h2>

<p>Of course, there are times when regular expressions can or should be used in programs:</p>

<ul>
  <li>When it already exist and you have to maintain it (although if you can remove it, you should)</li>
  <li>String validation, where there’s no other option</li>
  <li>String manipulation (substitution), where there’s no other option</li>
</ul>

<p>If you are writing anything more than the most basic regex, any maintainers are unlikely to be able to understand your regex easily, so you might want to consider adding liberal comments. E.g. <a href="https://softwareengineering.stackexchange.com/questions/178355/commenting-regular-expressions">this in Python</a>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">pattern</span> <span class="o">=</span> <span class="s">"""
^                   # beginning of string
M{0,4}              # thousands - 0 to 4 M's
(CM|CD|D?C{0,3})    # hundreds - 900 (CM), 400 (CD), 0-300 (0 to 3 C's),
                    #            or 500-800 (D, followed by 0 to 3 C's)
(XC|XL|L?X{0,3})    # tens - 90 (XC), 40 (XL), 0-30 (0 to 3 X's),
                    #        or 50-80 (L, followed by 0 to 3 X's)
(IX|IV|V?I{0,3})    # ones - 9 (IX), 4 (IV), 0-3 (0 to 3 I's),
                    #        or 5-8 (V, followed by 0 to 3 I's)
$                   # end of string
"""</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="s">'M'</span><span class="p">,</span> <span class="n">re</span><span class="p">.</span><span class="n">VERBOSE</span><span class="p">)</span> 
</code></pre></div></div>

<h2 id="other-great-uses-for-regex">Other great uses for regex</h2>

<p>Regular expressions can be extremely powerful for quickly solving problems for yourself, where future maintenance is not a concern. E.g.:</p>

<ul>
  <li><a href="https://en.wikipedia.org/wiki/Grep">Grep</a> (or <a href="https://github.com/BurntSushi/ripgrep">Ripgrep</a>), <a href="https://en.wikipedia.org/wiki/Sed">Sed</a>, <a href="https://en.wikipedia.org/wiki/Less_(Unix)">Less</a> and other command line tools</li>
  <li>In editors (e.g. <a href="https://docs.microsoft.com/en-us/visualstudio/ide/using-regular-expressions-in-visual-studio?view=vs-2019#capture-groups-and-replacement-patterns">VSCode</a>), for quickly reformatting text</li>
</ul>

<p>It’s also worth taking advantage of opportunities to use regex in these ways to practice your regex skills.</p>

<p>For example, I recently used the following regex substitution in VSCode to format a dump of text into a table format:</p>

<p><img src="https://lh6.googleusercontent.com/dR5m7AyBayo8O9JFzjjfGlO-wdKSaIBxb_kxIfDGnJMGKmWI8Y2dDwmNAUlUjMlli6I5UtH3OheTGTmY9hEEluj6ieab68TbXG8oxk0QoSTV_SKQb1af95SXHoieMoOynVUqX44C" alt="regex replacement in VSCode" /></p>

<h1 id="how-to-use-regex">How to use regex</h1>

<p>Bear in mind that regular expressions parsers come in a few varieties. Basically, <a href="https://en.m.wikipedia.org/wiki/Comparison_of_regular-expression_engines">every language implements its own parser</a>. However, Perl’s regex parser is the gold standard. If you have a choice, use <a href="https://www.pcre.org/">Perl Compatible Regular Expressions</a>.</p>

<h2 id="what-regex-looks-like">What regex looks like</h2>

<p>The traditional way to write a regular expression is by surrounding it with slashes.</p>

<div class="language-perl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="sr">/^he[l]{2}o\wworld$/</span>
</code></pre></div></div>

<p>This is how they’re written in Perl and JavaScript, and in many command-line tools like Less.</p>

<p>Many more modern languages (e.g. Python), however, have opted not to include a native regex type, and so regular expressions are simply written as strings:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="sa">r</span><span class="s">"^he[l]{2}o\wworld$"</span>
</code></pre></div></div>

<h2 id="common-regex-characters">Common regex characters</h2>

<table>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">.</code></td>
      <td>Matches any single character (except newlines, normally)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">\</code></td>
      <td>Escape a special character (e.g. <code class="language-plaintext highlighter-rouge">\.</code> matches a literal dot)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">?</code></td>
      <td>The preceding character may or may not be present (e.g. <code class="language-plaintext highlighter-rouge">/hell?o/</code> would match <code class="language-plaintext highlighter-rouge">hello</code> or <code class="language-plaintext highlighter-rouge">helo</code>)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">*</code></td>
      <td>Any number of the preceding character is allowed (e.g. <code class="language-plaintext highlighter-rouge">.*</code> will match any single-line string, including an empty string, and gets used a lot)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">+</code></td>
      <td>One or more of the preceding character (<code class="language-plaintext highlighter-rouge">.+</code> is the same as <code class="language-plaintext highlighter-rouge">.*</code> except that it won’t match an empty string)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">|</code></td>
      <td>“or”, match the preceding section or the following section (e.g. <code class="language-plaintext highlighter-rouge">hello|mad</code> will match “hello” or “mad”)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">()</code></td>
      <td>group a section together. This can be useful for conditionals (<code class="language-plaintext highlighter-rouge">(a|b)</code>), multipliers (<code class="language-plaintext highlighter-rouge">(hello)+</code>), or to create groups for substitutions (see below)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">{}</code></td>
      <td>Specify how many of the preceding character (e.g. <code class="language-plaintext highlighter-rouge">a{12}</code> matches 12 “a”s in a row)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">[]</code></td>
      <td>Match any character in this set. <code class="language-plaintext highlighter-rouge">-</code> defines ranges (e.g. <code class="language-plaintext highlighter-rouge">[a-z]</code> is any lowercase letter), <code class="language-plaintext highlighter-rouge">^</code> means “not” (e.g. <code class="language-plaintext highlighter-rouge">[^,]+</code> match any number of non-commas in a row)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">^</code></td>
      <td>Beginning of line</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">$</code></td>
      <td>End of line</td>
    </tr>
  </tbody>
</table>

<h2 id="character-shortcuts-in-regex">Character shortcuts in regex</h2>

<p>In most regex implementations, you can use backslash followed by a letter (<code class="language-plaintext highlighter-rouge">\x</code>) as a shortcut for a character set. Here’s a list of some common ones from <a href="https://www.rexegg.com/regex-quickstart.html">rexegg.com’s regex cheat sheet</a>.</p>

<p><img src="https://lh5.googleusercontent.com/mLDT-nkK2WI62ovJy_t5GCadgA82pQ_W8FA_23Yvs0uPD0x4WPdq6mbgPj-GTHiePU5bLKiT7bStwgJzPq8boyreFekfcP21FFDVD9NDom1XXTPPAzw_2la0Fixbv6e2UPNlktPu" alt="RexEgg character table" /></p>

<h2 id="regex-in-conditionals">Regex in conditionals</h2>

<p>The simplest use-case for regexes in programming is a string comparison. This looks different in different languages, e.g.:</p>

<div class="language-perl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="sr">//</span> <span class="nv">Perl</span>
<span class="k">if</span> <span class="p">(</span> <span class="p">"</span><span class="s2">hello world</span><span class="p">"</span> <span class="o">=~</span> <span class="sr">/^he[l]{2}o\sworld$/</span> <span class="p">)</span> <span class="p">{</span><span class="o">..</span><span class="p">}</span>
</code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// JavaScript</span>
<span class="k">if</span><span class="p">(</span> <span class="sr">/^he</span><span class="se">[</span><span class="sr">l</span><span class="se">]{2}</span><span class="sr">o</span><span class="se">\s</span><span class="sr">world$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="dl">"</span><span class="s2">hello world</span><span class="dl">"</span><span class="p">)</span> <span class="p">)</span> <span class="p">{..}</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Python
</span><span class="kn">import</span> <span class="nn">re</span>
<span class="k">if</span> <span class="n">re</span><span class="p">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s">"^he[l]{2}o\sworld$"</span><span class="p">,</span> <span class="s">"hello world"</span><span class="p">):</span> <span class="p">..</span>
</code></pre></div></div>

<h2 id="regex-in-substitutions">Regex in substitutions</h2>

<p>You can also use regex to manipulate strings through substitution. In the following examples, “mad world” will be printed out:</p>

<div class="language-perl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="sr">//</span> <span class="nv">Perl</span>
<span class="nv">$hw</span> <span class="o">=</span> <span class="p">"</span><span class="s2">hello world</span><span class="p">";</span> <span class="nv">$hw</span> <span class="o">=~</span> <span class="sr">s/^(he[l]{2}o)\s(world)$/mad \2/</span><span class="p">;</span> <span class="k">print</span><span class="p">(</span><span class="nv">$hw</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// JavaScript</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">hello world</span><span class="dl">"</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^</span><span class="se">(</span><span class="sr">he</span><span class="se">[</span><span class="sr">l</span><span class="se">]{2}</span><span class="sr">o</span><span class="se">)\s(</span><span class="sr">world</span><span class="se">)</span><span class="sr">$/</span><span class="p">,</span> <span class="dl">"</span><span class="s2">mad $2</span><span class="dl">"</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Python
</span><span class="kn">import</span> <span class="nn">re</span>
<span class="k">print</span><span class="p">(</span><span class="n">re</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s">"^(he[l]{2}o)\s(world)$"</span><span class="p">,</span> <span class="sa">r</span><span class="s">"mad \2"</span><span class="p">,</span> <span class="s">"hello world"</span><span class="p">))</span>
</code></pre></div></div>

<h2 id="regex-modifiers">Regex modifiers</h2>

<p>You can alter how regular expressions behave based on a few <a href="https://www.rexegg.com/regex-modifiers.html">modifiers</a>. I’m just going to illustrate one here, which is the modifier to make regex case insensitive. In Perl, JavaScript and other more traditional regex contexts, the modifiers are added after the last <code class="language-plaintext highlighter-rouge">/</code>. More modern languages often user constants instead:</p>

<div class="language-perl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="sr">//</span> <span class="nv">Perl</span>
<span class="k">if</span> <span class="p">(</span> <span class="p">"</span><span class="s2">HeLlO wOrLd</span><span class="p">"</span> <span class="o">=~</span> <span class="sr">/^he[l]{2}o\sworld$/i</span> <span class="p">)</span> <span class="p">{</span><span class="o">..</span><span class="p">}</span>
</code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// JavaScript</span>
<span class="k">if</span><span class="p">(</span> <span class="sr">/^he</span><span class="se">[</span><span class="sr">l</span><span class="se">]{2}</span><span class="sr">o</span><span class="se">\s</span><span class="sr">world$/i</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="dl">"</span><span class="s2">HeLlO wOrLd</span><span class="dl">"</span><span class="p">)</span> <span class="p">)</span> <span class="p">{..}</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Python
</span><span class="kn">import</span> <span class="nn">re</span>
<span class="k">if</span> <span class="n">re</span><span class="p">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s">"^he[l]{2}o\sworld$"</span><span class="p">,</span> <span class="s">"HeLlO wOrLd"</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="p">.</span><span class="n">IGNORECASE</span><span class="p">):</span> <span class="p">..</span>
</code></pre></div></div>

<h2 id="lookahead-and-lookbehind-in-regex">Lookahead and lookbehind in regex</h2>

<p>These are only supported in some implementations of regular expressions, and give you the opportunity to match strings that precede or follow other strings, but without including the prefix or suffix in the match itself:</p>

<p><img src="https://lh4.googleusercontent.com/WIc9KXTDsqV-j14f5aJwfDXPQTHjAG6ybL8RUR1d7cR-Px0gq4YpOBoPzI0e7Q5KzllNAB0AMw_3UU0UOT5gEWWawWDjlAwYEzhR6qnc6D20pEmoK4r759e3p0R-EFfjTYPwT5xE" alt="RexEgg lookaround table" /></p>

<p>(Again, taken from <a href="https://www.rexegg.com/regex-quickstart.html">rexegg.com’s regex cheat sheet</a>)</p>

<h1 id="regex-resources">Regex resources</h1>

<p>That is all I have for now. If you want to learn more, there’s are a lot of useful resources out there:</p>

<ul>
  <li><a href="https://www.rexegg.com/">Rexegg.com</a> - Many great articles on most aspects of regex</li>
  <li><a href="https://regex101.com/">Regex101</a> - A tester for your regex, offering a few different implementations</li>
  <li><a href="https://ihateregex.io/">iHateRegex</a> - A collection of example regex patterns for matching some common types of strings (e.g. phone number, email address)</li>
  <li>The official <a href="https://www.pcre.org/current/doc/html/">Perl Compatible Regular Expressions documentation</a></li>
</ul>


  
</article>

<script>
  /**
   * Document outline
   */

  // Get elements
  let article = document.querySelector("article");
  let headings = document.querySelector(".headings");
  let list = headings.querySelector("ol");

  // Populate nav
  article.querySelectorAll("h1, h2").forEach(function (heading) {
    let item = document.createElement("li");
    item.classList.add(heading.tagName.toLowerCase());
    item.innerHTML = `<a href="#${heading.id}">${heading.textContent}</a>`;
    list.appendChild(item);
  });

  function toggleHeadings() {
    // Don't show if there's not space
    if (article.offsetLeft < 180) {
      headings.style.display = "none";
      return;
    }

    // More compact layout
    if (article.offsetLeft < 350) {
      list.style.marginRight = "1.5em";
    } else {
      list.style.marginRight = "6em";
    }

    let articleBounding = article.getBoundingClientRect();
    let rightOffset = document.body.offsetWidth - articleBounding.left;

    headings.style.display = "block";
    headings.style.right = rightOffset + "px";

    if (articleBounding.top > 0) {
      headings.style.top = articleBounding.top + "px";
    } else {
      headings.style.top = 0;
    }
  }

  window.addEventListener('scroll', toggleHeadings);
  window.addEventListener('resize', toggleHeadings);

  toggleHeadings();
</script>

<address class="author">
  By <a href="https://twitter.com/nottrobin">@nottrobin</a>
</address>





<nav class="more-posts">
  <h2>More posts</h2>
  
  <p>
    <a href="/blogging-from-my-phone-with-gitjournal">Blogging from my phone with GitJournal</a><br>
    <time datetime="2022-06-05">5th June 2022</time>
  </p>
  
  
  <p>
    <a href="/links">Sources of good information</a><br>
    <time datetime="2021-06-29">29th June 2021</time>
  </p>
  
  
  <p>
    <a href="/font-layout-shift">Font loading performance and Cumulative Layout Shift</a><br>
    <time datetime="2021-02-02">2nd February 2021</time>
  </p>
  
</nav>


  <footer class="see-the-code">
    <a href="https://github.com/nottrobin/robinwinslow.uk">☵ See the code</a>
  </footer>

  <!-- Instant.page -->
  <script>
    let mouseoverTimer; let lastTouchTimestamp; const prefetches = new Set; const prefetchElement = document.createElement("link"); const isSupported = prefetchElement.relList && prefetchElement.relList.supports && prefetchElement.relList.supports("prefetch") && window.IntersectionObserver && "isIntersecting" in IntersectionObserverEntry.prototype; const allowQueryString = "instantAllowQueryString" in document.body.dataset; const allowExternalLinks = "instantAllowExternalLinks" in document.body.dataset; const useWhitelist = "instantWhitelist" in document.body.dataset; const mousedownShortcut = "instantMousedownShortcut" in document.body.dataset; const DELAY_TO_NOT_BE_CONSIDERED_A_TOUCH_INITIATED_ACTION = 1111; let delayOnHover = 65; let useMousedown = false; let useMousedownOnly = false; let useViewport = false; if ("instantIntensity" in document.body.dataset) { const intensity = document.body.dataset.instantIntensity; if (intensity.substr(0, "mousedown".length) == "mousedown") { useMousedown = true; if (intensity == "mousedown-only") { useMousedownOnly = true } } else if (intensity.substr(0, "viewport".length) == "viewport") { if (!(navigator.connection && (navigator.connection.saveData || navigator.connection.effectiveType && navigator.connection.effectiveType.includes("2g")))) { if (intensity == "viewport") { if (document.documentElement.clientWidth * document.documentElement.clientHeight < 45e4) { useViewport = true } } else if (intensity == "viewport-all") { useViewport = true } } } else { const milliseconds = parseInt(intensity); if (!isNaN(milliseconds)) { delayOnHover = milliseconds } } } if (isSupported) { const eventListenersOptions = { capture: true, passive: true }; if (!useMousedownOnly) { document.addEventListener("touchstart", touchstartListener, eventListenersOptions) } if (!useMousedown) { document.addEventListener("mouseover", mouseoverListener, eventListenersOptions) } else if (!mousedownShortcut) { document.addEventListener("mousedown", mousedownListener, eventListenersOptions) } if (mousedownShortcut) { document.addEventListener("mousedown", mousedownShortcutListener, eventListenersOptions) } if (useViewport) { let triggeringFunction; if (window.requestIdleCallback) { triggeringFunction = (callback => { requestIdleCallback(callback, { timeout: 1500 }) }) } else { triggeringFunction = (callback => { callback() }) } triggeringFunction(() => { const intersectionObserver = new IntersectionObserver(entries => { entries.forEach(entry => { if (entry.isIntersecting) { const linkElement = entry.target; intersectionObserver.unobserve(linkElement); preload(linkElement.href) } }) }); document.querySelectorAll("a").forEach(linkElement => { if (isPreloadable(linkElement)) { intersectionObserver.observe(linkElement) } }) }) } } function touchstartListener(event) { lastTouchTimestamp = performance.now(); const linkElement = event.target.closest("a"); if (!isPreloadable(linkElement)) { return } preload(linkElement.href) } function mouseoverListener(event) { if (performance.now() - lastTouchTimestamp < DELAY_TO_NOT_BE_CONSIDERED_A_TOUCH_INITIATED_ACTION) { return } const linkElement = event.target.closest("a"); if (!isPreloadable(linkElement)) { return } linkElement.addEventListener("mouseout", mouseoutListener, { passive: true }); mouseoverTimer = setTimeout(() => { preload(linkElement.href); mouseoverTimer = undefined }, delayOnHover) } function mousedownListener(event) { const linkElement = event.target.closest("a"); if (!isPreloadable(linkElement)) { return } preload(linkElement.href) } function mouseoutListener(event) { if (event.relatedTarget && event.target.closest("a") == event.relatedTarget.closest("a")) { return } if (mouseoverTimer) { clearTimeout(mouseoverTimer); mouseoverTimer = undefined } } function mousedownShortcutListener(event) { if (performance.now() - lastTouchTimestamp < DELAY_TO_NOT_BE_CONSIDERED_A_TOUCH_INITIATED_ACTION) { return } const linkElement = event.target.closest("a"); if (event.which > 1 || event.metaKey || event.ctrlKey) { return } if (!linkElement) { return } linkElement.addEventListener("click", function (event) { if (event.detail == 1337) { return } event.preventDefault() }, { capture: true, passive: false, once: true }); const customEvent = new MouseEvent("click", { view: window, bubbles: true, cancelable: false, detail: 1337 }); linkElement.dispatchEvent(customEvent) } function isPreloadable(linkElement) { if (!linkElement || !linkElement.href) { return } if (useWhitelist && !("instant" in linkElement.dataset)) { return } if (!allowExternalLinks && linkElement.origin != location.origin && !("instant" in linkElement.dataset)) { return } if (!["http:", "https:"].includes(linkElement.protocol)) { return } if (linkElement.protocol == "http:" && location.protocol == "https:") { return } if (!allowQueryString && linkElement.search && !("instant" in linkElement.dataset)) { return } if (linkElement.hash && linkElement.pathname + linkElement.search == location.pathname + location.search) { return } if ("noInstant" in linkElement.dataset) { return } return true } function preload(url) { if (prefetches.has(url)) { return } const prefetcher = document.createElement("link"); prefetcher.rel = "prefetch"; prefetcher.href = url; document.head.appendChild(prefetcher); prefetches.add(url) }
  </script>
</body>

</html>
